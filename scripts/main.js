// Generated by Construct, the game and animation creation tool
// Visit: https://www.construct.net

"use strict";window.i=class{constructor(t,s){this.h=t,this.o=s,this.l=!1,this.u=()=>this.m()}v(){}S(t,s,i,e){this.h._(this.o,t,s,i,e)}O(t,s,i,e){return this.h.P(this.o,t,s,i,e)}M(t,s,i){this.h.C()?this.S(t,s,i):this.h.R({type:"event",component:this.o,handler:t,dispatchOpts:i||null,data:s,responseId:null})}T(t,s){this.h.I(this.o,t,s)}A(t){for(const[s,i]of t)this.T(s,i)}G(){return this.h}F(){return this.o}D(){this.l||(this.h.L(this.u),this.l=!0)}W(){this.l&&(this.h.U(this.u),this.l=!1)}m(){}},window.H=class{constructor(t,s){this.V=t,this.B=s,this.N=-1,this.$=-1/0,this.j=()=>this.Y(),this.X=!1,this.J=!1}K(t){this.J=!!t}Z(){if(-1!==this.N)return;const t=Date.now(),s=t-this.$,i=this.B;s>=i&&this.J?(this.$=t,this.tt()):this.N=self.setTimeout(this.j,Math.max(i-s,4))}tt(){this.X=!0,this.V(),this.X=!1}st(){this.X||(this.it(),this.$=Date.now())}Y(){this.N=-1,this.$=Date.now(),this.tt()}it(){-1!==this.N&&(self.clearTimeout(this.N),this.N=-1)}et(){this.it(),this.V=null,this.j=null}};{class t{constructor(t){this.nt=t,this.ht=!1,this.ot=!0,this.rt=-1,this.ct=-1,this.lt=-1}ut(t){this.ot=!!t}dt(){return this.ot}wt(){return this.ht}ft(){this.ht=!0}yt(){return this.rt}gt(t){this.rt=t}vt(){return this.ct}bt(t){this.ct=t}St(t){this.lt=t}_t(){return this.lt}kt(){return this.nt}}window.Ot=class extends self.i{constructor(t,s){super(t,s),this.xt=new Map,this.Pt=!0,this.A([["create",t=>this.Mt(t)],["destroy",t=>this.Ct(t)],["set-visible",t=>this.Rt(t)],["update-position",t=>this.Tt(t)],["update-state",t=>this.It(t)],["focus",t=>this.At(t)],["set-css-style",t=>this.Et(t)],["set-attribute",t=>this.Gt(t)],["remove-attribute",t=>this.Ft(t)]]),this.Dt("get-element",t=>t)}Lt(t){this.Pt=!!t}Dt(t,s){this.T(t,t=>{const i=t.elementId,e=this.Wt(i);return s(e,t)})}Ut(t){for(const[s,i]of t)this.Dt(s,i)}Mt(s){const i=s.elementId,e=this.Ht(i,s),n=new t(e);this.xt.set(i,n),e.style.boxSizing="border-box",e.style.display="none",n.ut(s.isVisible);const h=this.Vt(e);h.addEventListener("focus",t=>this.Bt(i)),h.addEventListener("blur",t=>this.Nt(i));const o=s.htmlIndex;if(n.gt(o),n.St(s.htmlZIndex),this.Pt){const t=this.G().zt(o);n.bt(t),this.G().qt(t).appendChild(e)}}Ht(t,s){throw new Error("required override")}$t(t){}Ct(t){const s=t.elementId,i=this.Wt(s);this.$t(i),this.Pt&&i.parentElement.removeChild(i),this.xt.delete(s)}jt(t,s,i){i||(i={}),i.elementId=s,this.S(t,i)}Yt(t,s,i){i||(i={}),i.elementId=s,this.M(t,i)}Rt(t){if(!this.Pt)return;const s=this.xt.get(t.elementId),i=s.kt();s.wt()?i.style.display=t.isVisible?"":"none":s.ut(t.isVisible)}Tt(t){if(!this.Pt)return;const s=this.xt.get(t.elementId),i=s.kt(),e=this.G();i.style.left=t.left+"px",i.style.top=t.top+"px",i.style.width=t.width+"px",i.style.height=t.height+"px";const n=t.fontSize;null!==n&&(i.style.fontSize=n+"em");const h=t.htmlIndex;s.gt(h);const o=e.zt(h);o!==s.vt()&&(i.remove(),e.qt(o).appendChild(i),s.bt(o),e.Xt());const r=t.htmlZIndex;r!==s._t()&&(s.St(r),e.Xt()),s.wt()||(s.ft(),s.dt()&&(i.style.display=""))}Jt(){if(this.Pt)for(const t of this.xt.values()){const s=this.G().zt(t.yt()),i=t.vt();if(-1!==s&&-1!==i&&s!==i){const i=t.kt();i.remove(),this.G().qt(s).appendChild(i),t.bt(s)}}}Kt(){return this.Pt?[...this.xt.values()]:null}It(t){const s=this.Wt(t.elementId);this.Zt(s,t)}Zt(t,s){throw new Error("required override")}Vt(t){return t}Bt(t){this.jt("elem-focused",t)}Nt(t){this.jt("elem-blurred",t)}At(t){const s=this.Vt(this.Wt(t.elementId));t.focus?s.focus():s.blur()}Et(t){const s=this.Wt(t.elementId),i=t.prop,e=t.val;i.startsWith("--")?s.style.setProperty(i,e):s.style[i]=e}Gt(t){this.Wt(t.elementId).setAttribute(t.name,t.val)}Ft(t){this.Wt(t.elementId).removeAttribute(t.name)}Wt(t){const s=this.xt.get(t);if(!s)throw new Error(`no element with id ${t}`);return s.kt()}}}{const s=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),i=/android/i.test(navigator.userAgent),e=/safari/i.test(navigator.userAgent)&&!/(chrome|chromium|edg\/|OPR\/)/i.test(navigator.userAgent);let n=0;function h(t){const s=document.createElement("script");return s.async=!1,s.type="module",t.Qt?new Promise(i=>{const e="c3_resolve_"+n;++n,self[e]=i,s.textContent=t.ts+`\n\nself["${e}"]();`,document.head.appendChild(s)}):new Promise((i,e)=>{s.onload=i,s.onerror=e,s.src=t,document.head.appendChild(s)})}async function o(){if(!navigator.userActivation||"undefined"==typeof OffscreenCanvas)return!1;try{let t=!1;const s=new Blob(['\n\tself.addEventListener("message", () =>\n\t{\n\t\ttry {\n\t\t\tconst offscreenCanvas = new OffscreenCanvas(32, 32);\n\t\t\tconst gl = offscreenCanvas.getContext("webgl");\n\t\t\tself.postMessage(!!gl);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tconsole.warn("Feature detection worker error:", err);\n\t\t\tself.postMessage(false);\n\t\t}\n\t});'],{type:"text/javascript"}),i=new Worker(URL.createObjectURL(s),{get type(){t=!0}}),e=await new Promise(t=>{i.addEventListener("message",s=>{i.terminate(),t(s.data)}),i.postMessage("")});return t&&e}catch(t){return console.warn("Error feature detecting worker mode: ",t),!1}}let r=new Audio;const a={"audio/webm; codecs=opus":!!r.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!r.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!r.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!r.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!r.canPlayType("audio/mp4"),"audio/mpeg":!!r.canPlayType("audio/mpeg")};r=null,window.RealFile=window.File;const c=[],l=new Map,u=new Map;let d=0;const w=[];self.runOnStartup=function(t){if("function"!=typeof t)throw new Error("runOnStartup called without a function");w.push(t)};const f=new Set(["cordova","playable-ad-single-file","playable-ad-zip","instant-games"]);function m(t){return f.has(t)}let p=!1;window.ss=class t{#t=!0;#s=null;#i="";#e="";#n=null;#h=null;#o=[];#r=null;#a=!0;#c=[];#l=[];#u=!1;#d=()=>this.#w();#f=!1;#m=0;#p=null;#y=-1;#g=()=>this.#v();#b=new Set;#S=null;#_=[];#k=[];#O="";constructor(t){if(this.#t=t.es,this.#e=t.ns,this.#O=t.hs,"playable-ad-single-file"!==this.#O&&"playable-ad-zip"!==this.#O&&"instant-games"!==this.#O||(this.#t=!1),(e||"macos-wkwebview"===this.#O)&&(this.#t=!1),"cordova"===this.#O&&this.#t&&i){const t=/Chrome\/(\d+)/i.exec(navigator.userAgent);t&&parseInt(t[1],10)>=90||(this.#t=!1)}this.rs()?self.chrome.webview.addEventListener("message",t=>this.#x(t.data,t.additionalObjects)):"macos-wkwebview"===this.#O?self.C3WrapperOnMessage=t=>this.#x(JSON.parse(t)):"linux-cef"===this.#O&&self.c3_linux_cef_set_message_callback(t=>this.#x(JSON.parse(t))),this.cs=null,this.ls=null,"html5"!==this.#O||window.isSecureContext||console.warn("[Construct] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available."),this.I("canvas","update-size",t=>this.#P(t)),this.I("canvas","set-html-layer-count",t=>this._OnSetHTMLLayerCount(t)),this.I("canvas","cleanup-html-layers",()=>this.#M()),this.I("canvas","update-html-layer-dom-state",t=>this.#C(t.layersDomState)),this.I("runtime","create-job-worker",t=>this.#R(t)),this.I("runtime","send-wrapper-extension-message",t=>this.#T(t)),this.I("runtime","send-raw-wrapper-extension-message",t=>this.#I(t)),"cordova"===this.#O?document.addEventListener("deviceready",()=>this.#A(t)):this.#A(t),this.us=0}et(){this.ds(),this.#s&&(this.#s.onmessage=null,this.#s=null),this.#n&&(this.#n.terminate(),this.#n=null),this.#h&&(this.#h.et(),this.#h=null);for(const{canvas:t,ws:s}of this.#c)t.remove(),s.remove();this.#c.length=0}fs(){return this.#c[0].canvas}zt(t){return Math.min(t,this.#c.length-1)}qt(t){if(t<0||t>=this.#c.length)throw new RangeError("invalid canvas layer");return this.#c[t].ws}_GetHTMLWrapElement(t){return this.qt(t)}ps(){return this.#i}C(){return this.#t}ys(){return this.#O}gs(){return this.#e}vs(){return s&&"cordova"===this.#O}bs(){const t=navigator.userAgent;return s&&m(this.#O)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(t)}Ss(){return i}_s(){return i&&m(this.#O)}ks(){return"windows-webview2"===this.#O||!!("preview"===this.#O&&window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage)}rs(){return this.ks()||"xbox-uwp-webview2"===this.#O}Os(){this._s()&&this.us++}xs(){return this.Ps().next().value}*Ps(){if(!this._s())return!0;yield 0===this.us,this.us>0&&this.us--}async#A(t){if(this.#t&&(await o()||(this.#t=!1)),"macos-wkwebview"===this.#O&&this.Ms({type:"ready"}),this.rs()||"macos-wkwebview"===this.#O||"linux-cef"===this.#O){this.#E();const t=await this.#G();this.#_=t.registeredComponentIds}if("playable-ad-single-file"===this.#O&&(this.cs=self.c3_base64files,this.ls={},await this.#F()),t.Cs)this.#i=t.Cs;else{const t=location.origin;this.#i=("null"===t?"file:///":t)+location.pathname;const s=this.#i.lastIndexOf("/");-1!==s&&(this.#i=this.#i.substr(0,s+1))}const s=new MessageChannel;if(this.#s=s.port1,this.#s.onmessage=t=>this._OnMessageFromRuntime(t.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(t=>this.#D(t)),this.#p=new self.Rs(this),await this.#p.Ts(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen)try{await new Promise((t,s)=>{window.AndroidFullScreen.immersiveMode(t,s)})}catch(t){console.error("Failed to enter Android immersive mode: ",t)}this.#t?await this.#L(t,s.port2):await this.#W(t,s.port2)}#U(s){return{runtimeBaseUrl:this.#i,previewUrl:location.href,windowInnerWidth:this.Is(),windowInnerHeight:this.As(),cssDisplayMode:this.Es(),devicePixelRatio:window.devicePixelRatio,isFullscreen:t.Gs(),swClientId:window.cr_swClientId||"",exportType:s.hs,fileMap:globalThis.Fs??new Map(Object.entries(this.cs??{})),scriptFolder:this.#e,isDebug:new URLSearchParams(self.location.search).has("debug"),ife:!!self.Ds,jobScheduler:this.#p.Ls(),supportedAudioFormats:a,isiOSCordova:this.vs(),isiOSWebView:this.bs(),isWindowsWebView2:this.ks(),isAnyWebView2Wrapper:this.rs(),wrapperComponentIds:this.#_,isFBInstantAvailable:void 0!==self.FBInstant}}async#L(t,s){const i=t.Ws;"preview"===this.#O?(this.#n=new Worker("previewworker.js",{type:"module",name:"Runtime"}),await new Promise((t,s)=>{const e=i=>{this.#n.removeEventListener("message",e),i.data&&"ok"===i.data.type?t():s()};this.#n.addEventListener("message",e),this.#n.postMessage({type:"construct-worker-init",import:new URL(i,this.#i).toString()})})):this.#n=await this.Us(i,{type:"module",name:"Runtime"});const e=document.createElement("canvas");e.style.display="none";const n=e.transferControlToOffscreen();document.body.appendChild(e);const h=document.createElement("div");h.className="c3htmlwrap",h.setAttribute("interactive",""),document.body.appendChild(h),this.#c.push({canvas:e,ws:h,Hs:{isVisible:!0,opacity:1,Vs:!0}}),window.c3canvas=e,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.#n.postMessage(Object.assign(this.#U(t),{type:"init-runtime",isInWorker:!0,messagePort:s,canvas:n,runtimeScriptList:t.Bs,projectMainScriptPath:t.Ns,javaScriptInEventsPath:t.zs,typeScriptInEventsPath:t.qs}),[s,n,...this.#p.$s()]),this.#o=c.map(t=>new t(this)),this.#H(),this.#r.js(e),this.#r.Ys(h),this.#r.Xs(),self.c3_callFunction=(t,s)=>this.#r.Js(t,s),"preview"===this.#O&&(self.goToLastErrorScript=()=>this._("runtime","go-to-last-error-script"))}async#W(t,s){const i=document.createElement("canvas");i.style.display="none",document.body.appendChild(i);const e=document.createElement("div");e.className="c3htmlwrap",e.setAttribute("interactive",""),document.body.appendChild(e),this.#c.push({canvas:i,ws:e,Hs:{isVisible:!0,opacity:1,Vs:!0}}),window.c3canvas=i,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.#o=c.map(t=>new t(this)),this.#H(),this.#r.js(i),this.#r.Ys(e);const n=await Promise.all(t.Bs.map(t=>this.#V(t)));await Promise.all(n.map(t=>h(t)));const o=t.Ns,r=t.zs,a=t.qs;if(o)try{if(await h(o),"preview"===this.#O&&!globalThis.Ks)throw new Error("main script did not run to completion")}catch(t){this.#B(),console.error("Error loading project main script: ",t),alert(`Failed to load the project main script (${o}). Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the script. Press F12 and check the console for error details.`)}if(r)try{if(await h(r),"preview"===this.#O&&!globalThis.Qs.Zs)throw new Error("JavaScript in events did not run to completion")}catch(t){this.#B(),console.error("Error loading JavaScript in events: ",t),alert("Failed to load JavaScript in events. Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the 'Imports for events' script. Press F12 and check the console for error details.")}if(a)try{if(await h(a),"preview"===this.#O&&!globalThis.Qs.ti)throw new Error("TypeScript in events did not run to completion")}catch(t){this.#B(),console.error("Error loading TypeScript in events: ",t),alert("Failed to load TypeScript in events. Check all your TypeScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the 'Imports for events' script. Press F12 and check the console for error details.")}const l=Object.assign(this.#U(t),{isInWorker:!1,messagePort:s,canvas:i,runOnStartupFunctions:w});this.#r.Xs(),this.#N(),this.#h=self.C3_CreateRuntime(l),await self.C3_InitRuntime(this.#h,l)}async Us(t,s){if(t.startsWith("blob:"))return new Worker(t,s);if("playable-ad-single-file"===this.#O){const i=this.cs[t];if(!i)throw new Error("missing script: "+t);return new Worker(URL.createObjectURL(i),s)}const i=new URL(t,location.href);if(location.origin!==i.origin){const t=await fetch(i);if(!t.ok)throw new Error("failed to fetch worker script");const e=await t.blob();return new Worker(URL.createObjectURL(e),s)}return new Worker(i,s)}Is(){return Math.max(window.innerWidth,1)}As(){return Math.max(window.innerHeight,1)}Es(){if(this.rs())return"standalone";const t=this.ys();return new Set(["cordova","macos-wkwebview","linux-cef"]).has(t)?"standalone":window.matchMedia("(display-mode: fullscreen)").matches?"fullscreen":window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: minimal-ui)").matches?"minimal-ui":navigator.standalone?"standalone":"browser"}#N(){this.#B()}#B(){const t=window.cr_previewLoadingElem;t&&(t.parentElement.removeChild(t),window.cr_previewLoadingElem=null)}async#R(t){const s=await this.#p.si();return{outputPort:s,transferables:[s]}}#P(t){if(this.ii())return;const s=t.styleWidth+"px",i=t.styleHeight+"px",e=t.marginLeft+"px",n=t.marginTop+"px";for(const{canvas:t,ws:h}of this.#c)t.style.width=s,t.style.height=i,t.style.marginLeft=e,t.style.marginTop=n,h.style.width=s,h.style.height=i,h.style.marginLeft=e,h.style.marginTop=n,this.#a&&(t.style.display="",h.style.display="");document.documentElement.style.setProperty("--construct-scale",t.displayScale),this.#a=!1}_OnSetHTMLLayerCount(t){const s=t.count,i=t.layersDomState,e=t.immediate,n=t.styleWidth+"px",h=t.styleHeight+"px",o=t.marginLeft+"px",r=t.marginTop+"px",a=[],c=[];if(s<this.#c.length)for(;this.#c.length>s;){const{canvas:t,ws:s}=this.#c.pop();s.remove(),this.#t&&!e?this.#l.push(t):t.remove()}else if(s>this.#c.length)for(let t=0,i=s-this.#c.length;t<i;++t){const t=document.createElement("canvas");if(t.classList.add("c3overlay"),this.#t){const s=t.transferControlToOffscreen();a.push(s),c.push(s)}else a.push(t);document.body.appendChild(t);const s=document.createElement("div");s.classList.add("c3htmlwrap","c3overlay"),s.setAttribute("interactive",""),document.body.appendChild(s),t.style.width=n,t.style.height=h,t.style.marginLeft=o,t.style.marginTop=r,s.style.width=n,s.style.height=h,s.style.marginLeft=o,s.style.marginTop=r,this.#r.js(t),this.#r.Ys(s),this.#c.push({canvas:t,ws:s,Hs:{isVisible:!0,opacity:1,Vs:!0}})}this.#C(i);for(const t of this.#o)t instanceof window.Ot&&t.Jt();return this.Xt(),{addedCanvases:a,transferables:c}}#C(t){for(let s=0,i=Math.min(this.#c.length,t.length);s<i;++s){const{ws:i,Hs:e}=this.#c[s],n=t[s],h=n.isVisible,o=n.opacity,r=n.isInteractive;h!==e.isVisible&&(i.style.display=h?"":"none",e.isVisible=h),o!==e.opacity&&(i.style.opacity=1===o?"":String(o),e.opacity=o),r!==e.Vs&&(i.style.pointerEvents=r?"":"none",r?i.setAttribute("interactive",""):i.removeAttribute("interactive"),e.Vs=r)}}#M(){for(const t of this.#l)t.remove();this.#l.length=0}Xt(){this.#u||(this.#u=!0,this.L(this.#d))}#w(){this.U(this.#d),this.#u=!1;let t=[];for(const s of this.#o)if(s instanceof window.Ot){const i=s.Kt();i&&t.push(...i)}t.sort((t,s)=>{const i=t.vt(),e=s.vt();return i!==e?i-e:t._t()-s._t()});let s=0,i=0,e=0,n=t.length;for(;e<n;++e){const n=t[e];n.vt()!==s&&(this.#z(s,t.slice(i,e)),s=n.vt(),i=e)}i<e&&this.#z(s,t.slice(i,e))}#z(t,s){if(s.length<=1)return;if(t>=this.#c.length)return;const i=s.map(t=>t.kt()),e=new Set(i),n=this.qt(t),h=Array.from(n.children).filter(t=>e.has(t));for(let t=0,s=0,e=i.length;t<e;++t){const e=i[t],o=h[s];e===o?++s:n.moveBefore?n.moveBefore(e,o):n.insertBefore(e,o)}}R(t){if(this.#t)throw new Error("not available in worker mode");this.#h._OnMessageFromDOM(t)}_(t,s,i,e,n){this.#s.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:null},n)}P(t,s,i,e,n){const h=d++,o=new Promise((t,s)=>{u.set(h,{resolve:t,reject:s})});return this.#s.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:h},n),o}_OnMessageFromRuntime(t){const s=t.type;if("event"===s)return this.#q(t);if("result"===s)this.#$(t);else if("runtime-ready"===s)this.#j();else if("alert-error"===s)this.#B(),alert(t.message);else{if("creating-runtime"!==s)throw new Error(`unknown message '${s}'`);this.#N()}}#q(t){const s=t.component,i=t.handler,e=t.data,n=t.responseId,h=l.get(s);if(!h)return void console.warn(`[DOM] No event handlers for component '${s}'`);const o=h.get(i);if(!o)return void console.warn(`[DOM] No handler '${i}' for component '${s}'`);let r=null;try{r=o(e)}catch(t){return console.error(`Exception in '${s}' handler '${i}':`,t),void(null!==n&&this.#Y(n,!1,""+t))}if(null===n)return r;r&&r.then?r.then(t=>this.#Y(n,!0,t)).catch(t=>{console.error(`Rejection from '${s}' handler '${i}':`,t),this.#Y(n,!1,""+t)}):this.#Y(n,!0,r)}#Y(t,s,i){let e;i&&i.transferables&&(e=i.transferables),this.#s.postMessage({type:"result",responseId:t,isOk:s,result:i},e)}#$(t){const s=t.responseId,i=t.isOk,e=t.result,n=u.get(s);i?n.resolve(e):n.reject(e),u.delete(s)}I(t,s,i){let e=l.get(t);if(e||(e=new Map,l.set(t,e)),e.has(s))throw new Error(`[DOM] Component '${t}' already has handler '${s}'`);e.set(s,i)}static ei(t){if(c.includes(t))throw new Error("DOM handler already added");c.push(t)}#H(){for(const t of this.#o)if("runtime"===t.F())return void(this.#r=t);throw new Error("cannot find runtime DOM handler")}#D(t){this._("debugger","message",t)}#j(){for(const t of this.#o)t.v()}static Gs(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||p)}static ni(t){p=!!t}async hi(){return await this.P("runtime","get-remote-preview-status-info")}L(t){this.#b.add(t),this.oi()}U(t){this.#b.delete(t),0===this.#b.size&&this.ds()}oi(){-1===this.#y&&this.#b.size>0&&(this.#y=requestAnimationFrame(this.#g))}ds(){-1!==this.#y&&(cancelAnimationFrame(this.#y),this.#y=-1)}#v(){this.#y=-1;for(const t of this.#b)t();this.oi()}ri(t){this.#r.ri(t)}ai(t){this.#r.ai(t)}ci(){this.#r.ci()}li(t){this.#r.di(t)}wi(t){this.#r.fi(t)}mi(t){this.#r.mi(t)}pi(t){return!!a[t]}yi(t){this.#f=!0,this.#m=t}ii(){return this.#f}gi(){return this.#m}bi(t){return/^(?:[a-z\-]+:)?\/\//.test(t)||"data:"===t.substr(0,5)||"blob:"===t.substr(0,5)}Si(t){return!this.bi(t)}async#V(t){if("playable-ad-single-file"===this.#O){if(this.ls.hasOwnProperty(t))return{Qt:!0,ts:this.ls[t]};if(this.cs.hasOwnProperty(t))return URL.createObjectURL(this.cs[t]);throw new Error("missing script: "+t)}return t}_PlayableAdFetchBlob(t){if(this.cs.hasOwnProperty(t))return this.cs[t];throw new Error("missing file: "+t)}#X(){const t=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof t)throw new Error("Permission API is not loaded");return t}#J(t,s){const i=t[s];if("string"!=typeof i)throw new Error("Invalid permission name");return i}#K(t){const s=this.#X();return new Promise((i,e)=>s.checkPermission(this.#J(s,t),t=>i(!!t.hasPermission),e))}#Z(t){const s=this.#X();return new Promise((i,e)=>s.requestPermission(this.#J(s,t),t=>i(!!t.hasPermission),e))}async _i(t){if("cordova"!==this.ys())return!0;if(this.vs())return!0;for(const s of t)if(!await this.#K(s)&&!1===await this.#Z(s))return!1;return!0}async ki(...t){if(!1===await this._i(t))throw new Error("Permission not granted")}#x(s,i){if("object"!=typeof s||!s)return void console.warn("Unknown wrapper message: ",s);const e=s.type;if("directory-handles"===e)this.#k=i;else if("wrapper-init-response"===e)this.#S(s),this.#S=null;else if("fullscreen-change"===e)t.ni(s.isFullscreen),this.#r.Oi();else if("log-to-console"===e)switch(s.logType){case"error":console.error(s.message);break;case"warning":console.warn(s.message);break;default:console.log(s.message)}else if("window-maximized"==e||"window-minimized"==e){const t={"window-maximized":"windowmaximize","window-minimized":"windowminimize"};this._("runtime",t[e],null,{dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0})}else"extension-message"===e?this._("runtime","wrapper-extension-message",s):console.warn("Unknown wrapper message: ",s)}#T(t){this.Ms({type:"extension-message",componentId:t.componentId,messageId:t.messageId,params:t.params||[],asyncId:t.asyncId})}#I(t){this.Ms(t)}Ms(t){this.rs()?window.chrome.webview.postMessage(JSON.stringify(t)):"macos-wkwebview"===this.#O?window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(t)):"linux-cef"===this.#O&&window.c3_linux_cef_sendmessage(JSON.stringify(t))}#E(){window.moveTo=(t,s)=>{this.Ms({type:"set-window-position",windowX:Math.ceil(t),windowY:Math.ceil(s)})},window.resizeTo=(t,s)=>{this.Ms({type:"set-window-size",windowWidth:Math.ceil(t),windowHeight:Math.ceil(s)})},window.focus=()=>{this.Ms({type:"focus-window"})}}#G(){return new Promise(t=>{this.#S=t,this.Ms({type:"wrapper-init"})})}xi(){return this.#k}async#F(){const t=[];for(const[s,i]of Object.entries(this.cs))t.push(this.#Q(s,i));await Promise.all(t)}async#Q(t,s){if("object"==typeof s)this.cs[t]=new Blob([s.str],{type:s.type}),this.ls[t]=s.str;else{let i=await this.#tt(s);i||(i=this.#st(s)),this.cs[t]=i}}async#tt(t){try{const s=await fetch(t);return await s.blob()}catch(t){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",t),null}}#st(t){const s=this.#it(t);return this.#et(s.data,s.Pi)}#it(t){const s=t.indexOf(",");if(s<0)throw new URIError("expected comma in data: uri");const i=t.substring(5,s),e=t.substring(s+1),n=i.split(";"),h=n[0]||"",o=n[1],r=n[2];let a;return a="base64"===o||"base64"===r?atob(e):decodeURIComponent(e),{Pi:h,data:a}}#et(t,s){let i,e,n=t.length,h=n>>2,o=new Uint8Array(n),r=new Uint32Array(o.buffer,0,h);for(i=0,e=0;i<h;++i)r[i]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;let a=3&n;for(;a--;)o[e]=t.charCodeAt(e),++e;return new Blob([o],{type:s})}}}{const y=self.ss,g=/firefox/i.test(navigator.userAgent);function v(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||t.originalEvent&&t.originalEvent.sourceCapabilities&&t.originalEvent.sourceCapabilities.firesTouchEvents}const b=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),S={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},_={dispatchUserScriptEvent:!0},k={dispatchRuntimeEvent:!0};async function O(t){const s=URL.createObjectURL(t);try{return await(i=s,new Promise((t,s)=>{const e=new Image;e.onload=()=>t(e),e.onerror=t=>s(t),e.src=i}))}finally{URL.revokeObjectURL(s)}var i}function x(t){do{if(t.parentNode&&t.hasAttribute("contenteditable"))return!0;t=t.parentNode}while(t);return!1}const P=new Set(["input","textarea","datalist","select"]),M=new Set(["canvas","body","html"]);function C(t){if(!t.target.tagName)return;const s=t.target.tagName.toLowerCase();M.has(s)&&t.preventDefault()}function R(t){t.target.tagName&&t.target.classList.contains("c3htmlwrap")&&t.preventDefault()}function T(t){(t.metaKey||t.ctrlKey)&&t.preventDefault()}self.C3_GetSvgImageSize=async function(t){const s=await O(t);if(s.width>0&&s.height>0)return[s.width,s.height];{s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.visibility="hidden",document.body.appendChild(s);const t=s.getBoundingClientRect();return document.body.removeChild(s),[t.width,t.height]}},self.C3_RasterSvgImageBlob=async function(t,s,i,e,n){const h=await O(t),o=document.createElement("canvas");return o.width=e,o.height=n,o.getContext("2d").drawImage(h,0,0,s,i),o};let I=!1;function A(){try{return window.parent&&window.parent.document.hasFocus()}catch(t){return!1}}document.addEventListener("pause",()=>I=!0),document.addEventListener("resume",()=>I=!1);const E="runtime",G=class extends self.i{constructor(t){super(t,E),this.Mi=!1,this.Ci=-1,this.Ri="any",this.Ti=!1,this.Ii=!1,this.Ai=!1,this.Ei=!1,this.Gi=()=>this.Fi(),this.Di=new Set,this.Li=document.createElement("div"),this.Li.className="c3-screen-reader-text",this.Li.setAttribute("aria-live","polite"),document.body.appendChild(this.Li),this.Wi=null,this.Ui=!1,this.Hi="",this.Vi=-1,this.Bi=!1,this.Ni=t.Is(),this.zi=t.As(),this.$i=0,this.ji=0,t.I("runtime","invoke-download",t=>this.Yi(t)),t.I("runtime","load-webfonts",t=>this.Xi(t)),t.I("runtime","raster-svg-image",t=>this.Ji(t)),t.I("runtime","get-svg-image-size",t=>this.Ki(t)),t.I("runtime","set-target-orientation",t=>this.Zi(t)),t.I("runtime","register-sw",()=>this.Qi()),t.I("runtime","post-to-debugger",t=>this.te(t)),t.I("runtime","go-to-script",t=>this.te(t)),t.I("runtime","before-start-ticking",()=>this.se()),t.I("runtime","debug-highlight",t=>this.ie(t)),t.I("runtime","enable-device-orientation",()=>this.ee()),t.I("runtime","enable-device-motion",()=>this.ne()),t.I("runtime","add-stylesheet",t=>this.he(t)),t.I("runtime","script-create-worker",t=>this.oe(t)),t.I("runtime","alert",t=>this.re(t)),t.I("runtime","screen-reader-text",t=>this.ae(t)),t.I("runtime","hide-cordova-splash",()=>this.ce()),t.I("runtime","set-exporting-to-video",t=>this.le(t)),t.I("runtime","export-to-video-progress",t=>this.ue(t)),t.I("runtime","exported-to-video",t=>this.de(t)),t.I("runtime","exported-to-image-sequence",t=>this.we(t));const s=new Set(["input","textarea","datalist"]);if(window.addEventListener("contextmenu",t=>{const i=t.target,e=i.tagName.toLowerCase();s.has(e)||x(i)||t.preventDefault()}),window.addEventListener("selectstart",C),window.addEventListener("gesturehold",C),window.addEventListener("touchstart",C,{passive:!1}),window.addEventListener("pointerdown",C,{passive:!1}),this.fe=0,window.addEventListener("mousedown",t=>{1===t.button&&t.preventDefault()}),window.addEventListener("mousewheel",T,{passive:!1}),window.addEventListener("wheel",T,{passive:!1}),window.addEventListener("resize",()=>this.me()),window.addEventListener("fullscreenchange",()=>this.Oi()),window.addEventListener("webkitfullscreenchange",()=>this.Oi()),window.addEventListener("mozfullscreenchange",()=>this.Oi()),window.addEventListener("fullscreenerror",t=>this.pe(t)),window.addEventListener("webkitfullscreenerror",t=>this.pe(t)),window.addEventListener("mozfullscreenerror",t=>this.pe(t)),t.bs()){let t=1/0;window.visualViewport.addEventListener("resize",()=>{const s=window.visualViewport.height;s>t&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0),t=s}),document.documentElement.setAttribute("ioswebview","")}this.ye=new Set,this.ge=new WeakSet,this.ve=!1}js(t){t.addEventListener("selectstart",C),t.addEventListener("gesturehold",C),t.addEventListener("pointerdown",C)}Ys(t){t.addEventListener("selectstart",R),t.addEventListener("gesturehold",R),t.addEventListener("touchstart",R),t.addEventListener("dragstart",R)}se(){return self.setTimeout(()=>{this.Bi=!0},1e3),"cordova"===this.h.ys()?(document.addEventListener("pause",()=>this.be(!0)),document.addEventListener("resume",()=>this.be(!1))):document.addEventListener("visibilitychange",()=>this.be("hidden"===document.visibilityState)),this.Ai=!("hidden"!==document.visibilityState&&!I),{isSuspended:this.Ai}}v(){window.addEventListener("focus",()=>this.Se("window-focus")),window.addEventListener("blur",()=>{this.Se("window-blur",{parentHasFocus:A()}),this.fe=0}),window.addEventListener("focusin",t=>{var s;s=t.target,(P.has(s.tagName.toLowerCase())||x(s))&&this.Se("keyboard-blur")}),window.addEventListener("keydown",t=>this._e("keydown",t)),window.addEventListener("keyup",t=>this._e("keyup",t)),window.addEventListener("mousedown",t=>this.ke("mousedown",t,_)),window.addEventListener("mousemove",t=>this.ke("mousemove",t,_)),window.addEventListener("mouseup",t=>this.ke("mouseup",t,_)),window.addEventListener("dblclick",t=>this.ke("dblclick",t,S)),window.addEventListener("wheel",t=>this.Oe("wheel",t,S)),window.addEventListener("pointerdown",t=>{this.xe(t),this.Pe("pointerdown",t)}),this.h.C()&&void 0!==window.onpointerrawupdate&&self===self.top&&!g?window.addEventListener("pointerrawupdate",t=>this.Me(t)):window.addEventListener("pointermove",t=>this.Pe("pointermove",t)),window.addEventListener("pointerup",t=>this.Pe("pointerup",t)),window.addEventListener("pointercancel",t=>this.Pe("pointercancel",t));const t=()=>this.ci();window.addEventListener("pointerup",t,!0),window.addEventListener("touchend",t,!0),window.addEventListener("click",t,!0),window.addEventListener("keydown",t,!0),navigator.getGamepads().some(t=>!!t)&&(this.h.L(this.Gi),this.Ei=!0),window.addEventListener("gamepadconnected",()=>this.Ce(),!0),window.addEventListener("gamepaddisconnected",()=>this.Re(),!0),this.h.Ss()&&!this.h._s()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",()=>{this.Te(this.As(),navigator.virtualKeyboard.boundingRect.height)})),this.h.bs()&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0)}Te(t,s){if(document.body.style.position="",document.body.style.overflow="",document.body.style.transform="",this.ji=0,s>0){const i=document.activeElement;if(i){const e=i.getBoundingClientRect();let n=(e.top+e.bottom)/2-(t-s)/2;n>s&&(n=s),n<0&&(n=0),n>0&&(document.body.style.position="absolute",document.body.style.overflow="visible",document.body.style.transform=`translateY(${-n}px)`,this.ji=n)}}}Se(t,s){this.S(t,s||null,k)}Is(){return this.h.Is()}As(){return this.h.As()}Xs(){this.Mi=!0,this.Ni=this.h.Is(),this.zi=this.h.As()}me(){if(this.Ui)return;if(!this.Mi)return;const t=this.Is(),s=this.As();if(this.h._s())if(this.Bi){if(this.h.xs()&&this.Ni===t&&s<this.zi)return this.$i=this.zi-s,void this.Te(this.zi,this.$i);this.$i>0&&(this.$i=0,this.Te(s,this.$i)),this.Ni=t,this.zi=s}else this.Ni=t,this.zi=s;this.S("window-resize",{innerWidth:t,innerHeight:s,devicePixelRatio:window.devicePixelRatio,isFullscreen:y.Gs(),cssDisplayMode:this.h.Es()}),this.h.bs()&&(-1!==this.Ci&&clearTimeout(this.Ci),this.Ie(t,s,0))}Ae(t,s,i){-1!==this.Ci&&clearTimeout(this.Ci),this.Ci=setTimeout(()=>this.Ie(t,s,i),48)}Ie(t,s,i){const e=this.Is(),n=this.As();this.Ci=-1,e!=t||n!=s?this.S("window-resize",{innerWidth:e,innerHeight:n,devicePixelRatio:window.devicePixelRatio,isFullscreen:y.Gs(),cssDisplayMode:this.h.Es()}):i<10&&this.Ae(e,n,i+1)}Zi(t){this.Ri=t.targetOrientation}Ee(){const t=this.Ri;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(t).catch(t=>console.warn("[Construct] Failed to lock orientation: ",t));else try{let s=!1;screen.lockOrientation?s=screen.lockOrientation(t):screen.webkitLockOrientation?s=screen.webkitLockOrientation(t):screen.mozLockOrientation?s=screen.mozLockOrientation(t):screen.msLockOrientation&&(s=screen.msLockOrientation(t)),s||console.warn("[Construct] Failed to lock orientation")}catch(t){console.warn("[Construct] Failed to lock orientation: ",t)}}Oi(){if(this.Ui)return;const t=y.Gs();t&&"any"!==this.Ri&&this.Ee(),this.S("fullscreenchange",{isFullscreen:t,innerWidth:this.Is(),innerHeight:this.As()})}pe(t){console.warn("[Construct] Fullscreen request failed: ",t),this.S("fullscreenerror",{isFullscreen:y.Gs(),innerWidth:this.Is(),innerHeight:this.As()})}be(t){if(this.Ai!==t&&(this.Ai=t,t?this.h.ds():this.h.oi(),this.S("visibilitychange",{hidden:t}),!t&&this.h.bs())){const t=()=>{document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0};setTimeout(t,50),setTimeout(t,100),setTimeout(t,250),setTimeout(t,500)}}_e(t,s){if(void 0===s.key)return;if("Backspace"===s.key&&C(s),this.Ui)return;const i=b.get(s.code)||s.code;this.M(t,{code:i,key:s.key,which:s.which,repeat:s.repeat,altKey:s.altKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,shiftKey:s.shiftKey,timeStamp:s.timeStamp},S)}Oe(t,s,i){this.Ui||this.S(t,{clientX:s.clientX,clientY:s.clientY+this.ji,pageX:s.pageX,pageY:s.pageY+this.ji,deltaX:s.deltaX,deltaY:s.deltaY,deltaZ:s.deltaZ,deltaMode:s.deltaMode,timeStamp:s.timeStamp},i)}ke(t,s,i){this.Ui||v(s)||this.M(t,{button:s.button,buttons:s.buttons,clientX:s.clientX,clientY:s.clientY+this.ji,pageX:s.pageX,pageY:s.pageY+this.ji,movementX:s.movementX||0,movementY:s.movementY||0,timeStamp:s.timeStamp},i)}Pe(t,s){if(this.Ui)return;let i=0;"mouse"===s.pointerType&&(i=this.fe),this.M(t,{pointerId:s.pointerId,pointerType:s.pointerType,button:s.button,buttons:s.buttons,lastButtons:i,clientX:s.clientX,clientY:s.clientY+this.ji,pageX:s.pageX,pageY:s.pageY+this.ji,movementX:s.movementX||0,movementY:s.movementY||0,width:s.width||0,height:s.height||0,pressure:s.pressure||0,tangentialPressure:s.tangentialPressure||0,tiltX:s.tiltX||0,tiltY:s.tiltY||0,twist:s.twist||0,timeStamp:s.timeStamp},S),"mouse"===s.pointerType&&(this.fe=s.buttons)}Me(t){this.Pe("pointermove",t)}Ge(t,s){if(!this.Ui)for(let i=0,e=s.changedTouches.length;i<e;++i){const e=s.changedTouches[i];this.M(t,{pointerId:e.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:e.clientX,clientY:e.clientY+this.ji,pageX:e.pageX,pageY:e.pageY+this.ji,movementX:s.movementX||0,movementY:s.movementY||0,width:2*(e.radiusX||e.webkitRadiusX||0),height:2*(e.radiusY||e.webkitRadiusY||0),pressure:e.force||e.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:e.rotationAngle||0,timeStamp:s.timeStamp},S)}}xe(t){window!==window.top&&window.focus(),this.Fe(t.target)&&document.activeElement&&!this.Fe(document.activeElement)&&document.activeElement.blur()}Fe(t){return!t||t===document||t===window||t===document.body||"canvas"===t.tagName.toLowerCase()}ee(){this.Ti||(this.Ti=!0,window.addEventListener("deviceorientation",t=>this.De(t)),window.addEventListener("deviceorientationabsolute",t=>this.Le(t)))}ne(){this.Ii||(this.Ii=!0,window.addEventListener("devicemotion",t=>this.We(t)))}De(t){this.Ui||this.S("deviceorientation",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp,webkitCompassHeading:t.webkitCompassHeading,webkitCompassAccuracy:t.webkitCompassAccuracy},S)}Le(t){this.Ui||this.S("deviceorientationabsolute",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp},S)}We(t){if(this.Ui)return;let s=null;const i=t.acceleration;i&&(s={x:i.x||0,y:i.y||0,z:i.z||0});let e=null;const n=t.accelerationIncludingGravity;n&&(e={x:n.x||0,y:n.y||0,z:n.z||0});let h=null;const o=t.rotationRate;o&&(h={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this.S("devicemotion",{acceleration:s,accelerationIncludingGravity:e,rotationRate:h,interval:t.interval,timeStamp:t.timeStamp},S)}Yi(t){const s=t.url,i=t.filename,e=document.createElement("a"),n=document.body;e.textContent=i,e.href=s,e.download=i,n.appendChild(e),e.click(),n.removeChild(e)}async Xi(t){const s=t.webfonts;await Promise.all(s.map(async t=>{const s=new FontFace(t.name,`url('${t.url}')`);document.fonts.add(s),await s.load()}))}async Ji(t){const s=t.blob,i=t.imageWidth,e=t.imageHeight,n=t.surfaceWidth,h=t.surfaceHeight,o=t.imageBitmapOpts,r=await self.C3_RasterSvgImageBlob(s,i,e,n,h);let a;return a=o?await createImageBitmap(r,o):await createImageBitmap(r),{imageBitmap:a,transferables:[a]}}async Ki(t){return await self.C3_GetSvgImageSize(t.blob)}async he(t){var s;await(s=t.url,new Promise((t,i)=>{const e=document.createElement("link");e.onload=()=>t(e),e.onerror=t=>i(t),e.rel="stylesheet",e.href=s,document.head.appendChild(e)}))}ci(){const t=[...this.ye];if(this.ye.clear(),!this.ve)for(const s of t){const t=s.play();t&&t.catch(t=>{this.ge.has(s)||this.ye.add(s)})}}ri(t){if("function"!=typeof t.play)throw new Error("missing play function");let s;this.ge.delete(t);try{s=t.play()}catch(s){return void this.ye.add(t)}s&&s.catch(s=>{this.ge.has(t)||this.ye.add(t)})}ai(t){this.ye.delete(t),this.ge.add(t)}mi(t){this.ve=!!t}Ce(){this.Ei||(this.h.L(this.Gi),this.Ei=!0,this.Ue())}Re(){this.Ei&&navigator.getGamepads().every(t=>!t)&&(this.h.U(this.Gi),this.Ei=!1)}Fi(){navigator.getGamepads().some(t=>t&&t.buttons.some(t=>t.pressed))&&this.Ue()}Ue(){this.ci();for(const t of this.Di)t()}di(t){this.Di.add(t)}fi(t){this.Di.delete(t)}ce(){navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()}ie(t){if(!t.show)return void(this.Wi&&(this.Wi.style.display="none"));this.Wi||(this.Wi=document.createElement("div"),this.Wi.id="inspectOutline",document.body.appendChild(this.Wi));const s=this.Wi;s.style.display="",s.style.left=t.left-1+"px",s.style.top=t.top-1+"px",s.style.width=t.width+2+"px",s.style.height=t.height+2+"px",s.textContent=t.name}Qi(){window.C3_RegisterSW&&window.C3_RegisterSW()}te(t){window.c3_postToMessagePort&&(t.from="runtime",window.c3_postToMessagePort(t))}Js(t,s){return this.O("js-invoke-function",{name:t,params:s})}oe(t){const s=t.url,i=t.opts,e=t.port2;new Worker(s,i).postMessage({type:"construct-worker-init",port2:e},[e])}re(t){alert(t.message)}ae(t){const s=t.type;if("create"===s){const s=document.createElement("p");s.id="c3-sr-"+t.id,s.textContent=t.text,this.Li.appendChild(s)}else if("update"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.textContent=t.text:console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else if("release"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.remove():console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else console.warn(`[Construct] Unknown screen reader text update '${s}'`)}le(t){this.Ui=!0;const s=document.createElement("h1");s.id="exportToVideoMessage",s.textContent=t.message,document.body.prepend(s),document.body.classList.add("exportingToVideo"),this.G().fs().style.display="",this.h.yi(t.duration)}ue(t){this.Hi=t.message,-1===this.Vi&&(this.Vi=setTimeout(()=>this.He(),250))}He(){this.Vi=-1;const t=document.getElementById("exportToVideoMessage");t&&(t.textContent=this.Hi)}de(t){window.Ve({type:"exported-video",arrayBuffer:t.arrayBuffer,contentType:t.contentType,time:t.time})}we(t){window.Ve({type:"exported-image-sequence",blobArr:t.blobArr,time:t.time,gif:t.gif})}};y.ei(G)}{const F="dispatchworker.js",D="jobworker.js";self.Rs=class{constructor(t){this.Be=t,this.Ne=Math.min(navigator.hardwareConcurrency||2,16),this.ze=null,this.qe=[],this.$e=null,this.je=null}async Ts(){if(this.Ye)throw new Error("already initialised");this.Ye=!0;const t=this.Be.gs()+F;this.ze=await this.Be.Us(t,{name:"DispatchWorker"});const s=new MessageChannel;this.$e=s.port1,this.ze.postMessage({type:"_init","in-port":s.port2},[s.port2]),this.je=await this.si()}async si(){const t=this.qe.length,s=this.Be.gs()+D,i=await this.Be.Us(s,{name:"JobWorker"+t}),e=new MessageChannel,n=new MessageChannel;return this.ze.postMessage({type:"_addJobWorker",port:e.port1},[e.port1]),i.postMessage({type:"init",number:t,"dispatch-port":e.port2,"output-port":n.port2},[e.port2,n.port2]),this.qe.push(i),n.port1}Ls(){return{inputPort:this.$e,outputPort:this.je,maxNumWorkers:this.Ne}}$s(){return[this.$e,this.je]}}}{const L="touch",W=class extends self.i{constructor(t){super(t,L),this.T("request-permission",t=>this.Xe(t))}async Xe(t){const s=t.type;let i=!0;0===s?i=await this.Je():1===s&&(i=await this.Ke()),this.S("permission-result",{type:s,result:i})}async Je(){if(!self.DeviceOrientationEvent||!self.DeviceOrientationEvent.requestPermission)return!0;try{return"granted"===await self.DeviceOrientationEvent.requestPermission()}catch(t){return console.warn("[Touch] Failed to request orientation permission: ",t),!1}}async Ke(){if(!self.DeviceMotionEvent||!self.DeviceMotionEvent.requestPermission)return!0;try{return"granted"===await self.DeviceMotionEvent.requestPermission()}catch(t){return console.warn("[Touch] Failed to request motion permission: ",t),!1}}};self.ss.ei(W)}{let U=null,H=null;function V(t,s){if(t){if(s)return Array.from(document.querySelectorAll(t));{const s=document.querySelector(t);return s?[s]:[]}}return[document.documentElement]}function B(){}window.addEventListener("beforeinstallprompt",t=>(t.preventDefault(),U=t,H&&H.Ze(),!1));const N="browser",z=class extends self.i{constructor(t){super(t,N),this.Qe="",this.A([["get-initial-state",t=>this.tn(t)],["ready-for-sw-messages",()=>this.sn()],["alert",t=>this.re(t)],["close",()=>this.en()],["set-focus",t=>this.At(t)],["vibrate",t=>this.nn(t)],["lock-orientation",t=>this.hn(t)],["unlock-orientation",()=>this.rn()],["navigate",t=>this.an(t)],["request-fullscreen",t=>this.cn(t)],["exit-fullscreen",()=>this.ln()],["set-hash",t=>this.un(t)],["set-document-css-style",t=>this.dn(t)],["get-document-css-style",t=>this.wn(t)],["set-window-size",t=>this.fn(t)],["set-window-position",t=>this.mn(t)],["request-install",()=>this.pn()],["set-warn-on-close",t=>this.yn(t)]]),window.addEventListener("online",()=>this.gn(!0)),window.addEventListener("offline",()=>this.gn(!1)),window.addEventListener("hashchange",()=>this.vn()),window.addEventListener("fullscreenerror",()=>this.pe()),window.addEventListener("webkitfullscreenerror",()=>this.pe()),window.addEventListener("mozfullscreenerror",()=>this.pe()),this.bn=t=>t.preventDefault(),document.addEventListener("backbutton",()=>this.Sn())}v(){U?this.Ze():H=this,window.addEventListener("appinstalled",()=>this._n())}tn(t){return this.Qe=t.exportType,{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isConstructArcade:void 0!==window.is_scirra_arcade,windowHasFocus:document.hasFocus()}}sn(){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(t=>this.S("sw-message",t.data))}Ze(){this.S("install-available")}async pn(){if(!U)return{result:"unavailable"};try{return U.prompt(),{result:(await U.userChoice).outcome}}catch(t){return console.error("[Construct] Requesting install failed: ",t),{result:"failed"}}}_n(){this.S("app-installed")}gn(t){this.S("online-state",{isOnline:t})}Sn(){this.S("backbutton")}re(t){alert(t.message)}en(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():window.close()}At(t){t.isFocus?window.focus():window.blur()}nn(t){navigator.vibrate&&navigator.vibrate(t.pattern)}hn(t){const s=t.orientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(s).catch(t=>console.warn("[Construct] Failed to lock orientation: ",t));else try{let t=!1;screen.lockOrientation?t=screen.lockOrientation(s):screen.webkitLockOrientation?t=screen.webkitLockOrientation(s):screen.mozLockOrientation?t=screen.mozLockOrientation(s):screen.msLockOrientation&&(t=screen.msLockOrientation(s)),t||console.warn("[Construct] Failed to lock orientation")}catch(t){console.warn("[Construct] Failed to lock orientation: ",t)}}rn(){try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(t){}}an(t){const s=t.type;if("back"===s)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.history.back();else if("forward"===s)window.history.forward();else if("reload"===s)location.reload();else if("url"===s){const s=t.url,i=t.target,e=t.exportType;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(s,"_system"):"preview"===e||"macos-wkwebiew"===e||"linux-cef"===e||this.h.rs()?window.open(s,"_blank"):this.kn||(2===i?window.top.location=s:1===i?window.parent.location=s:window.location=s)}else if("new-window"===s){const s=t.url,i=t.tag;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(s,"_system"):window.open(s,i)}}cn(t){if(this.h.rs()||"macos-wkwebview"===this.Qe||"linux-cef"===this.Qe)self.ss.ni(!0),this.h.Ms({type:"set-fullscreen",fullscreen:!0});else{const s={navigationUI:"auto"},i=t.navUI;1===i?s.navigationUI="hide":2===i&&(s.navigationUI="show");const e=document.documentElement;let n;e.requestFullscreen?n=e.requestFullscreen(s):e.mozRequestFullScreen?n=e.mozRequestFullScreen(s):e.msRequestFullscreen?n=e.msRequestFullscreen(s):e.webkitRequestFullScreen&&(n=void 0!==Element.ALLOW_KEYBOARD_INPUT?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen()),n instanceof Promise&&n.catch(B)}}pe(){this.S("fullscreenerror")}ln(){if(this.h.rs()||"macos-wkwebview"===this.Qe||"linux-cef"===this.Qe)self.ss.ni(!1),this.h.Ms({type:"set-fullscreen",fullscreen:!1});else{let t;document.exitFullscreen?t=document.exitFullscreen():document.mozCancelFullScreen?t=document.mozCancelFullScreen():document.msExitFullscreen?t=document.msExitFullscreen():document.webkitCancelFullScreen&&(t=document.webkitCancelFullScreen()),t instanceof Promise&&t.catch(B)}}un(t){location.hash=t.hash}vn(){this.S("hashchange",{location:location.toString()})}dn(t){const s=t.prop,i=t.value,e=t.selector,n=t["is-all"];try{const t=V(e,n);for(const e of t)s.startsWith("--")?e.style.setProperty(s,i):e.style[s]=i}catch(t){console.warn("[Browser] Failed to set style: ",t)}}wn(t){const s=t.prop,i=t.selector;try{const t=document.querySelector(i);return t?{isOk:!0,result:window.getComputedStyle(t).getPropertyValue(s)}:{isOk:!1}}catch(t){return console.warn("[Browser] Failed to get style: ",t),{isOk:!1}}}fn(t){window.resizeTo(t.windowWidth,t.windowHeight)}mn(t){window.moveTo(t.windowX,t.windowY)}yn(t){t.enabled?window.addEventListener("beforeunload",this.bn):window.removeEventListener("beforeunload",this.bn)}};self.ss.ei(z)}{const q="text-input";function $(t){t.stopPropagation()}function j(t){13!==t.which&&27!==t.which&&t.stopPropagation()}const Y=class extends self.Ot{constructor(t){super(t,q),this.Dt("scroll-to-bottom",t=>this.On(t))}Ht(t,s){let i;const e=s.type;return"textarea"===e?(i=document.createElement("textarea"),i.style.resize="none"):(i=document.createElement("input"),i.type=e),i.style.position="absolute",i.autocomplete="off",i.addEventListener("pointerdown",$),i.addEventListener("pointerrawupdate",$),i.addEventListener("pointerup",$),i.addEventListener("mousedown",$),i.addEventListener("mouseup",$),i.addEventListener("keydown",j),i.addEventListener("keyup",j),i.addEventListener("click",s=>{s.stopPropagation(),this.Yt("click",t)}),i.addEventListener("dblclick",s=>{s.stopPropagation(),this.Yt("dblclick",t)}),i.addEventListener("input",()=>this.jt("change",t,{text:i.value})),s.id&&(i.id=s.id),s.className&&(i.className=s.className),this.Zt(i,s),i}Zt(t,s){t.value=s.text,t.placeholder=s.placeholder,t.title=s.title,t.disabled=!s.isEnabled,t.readOnly=s.isReadOnly,t.spellcheck=s.spellCheck;const i=s.maxLength;i<0?t.removeAttribute("maxlength"):t.setAttribute("maxlength",i)}On(t){t.scrollTop=t.scrollHeight}};self.ss.ei(Y)}{const X="localstorage",J=class extends self.i{constructor(t){super(t,X),this.A([["init",()=>this.xn()],["request-persistent",()=>this.Pn()]])}async xn(){let t=!1;try{t=await navigator.storage.persisted()}catch(s){t=!1,console.warn("[Construct] Error checking storage persisted state: ",s)}return{isPersistent:t}}async Pn(){try{return{isOk:!0,isPersistent:await navigator.storage.persist()}}catch(t){return console.error("[Construct] Error requesting persistent storage: ",t),{isOk:!1}}}};self.ss.ei(J)}{const K=180/Math.PI,Z="audio";self.Mn=class extends self.i{constructor(t){super(t,Z),this.Cn=null,this.Rn=null,this.Tn=!1,this.In=()=>this.An(),this.En=[],this.Gn=[],this.Fn=null,this.Dn=[],this.Ln=new Set,this.Wn=-1,this.Un=new Map,this.Hn=1,this.ve=!1,this.Vn=0,this.Bn=1,this.Nn=0,this.zn="HRTF",this.qn="inverse",this.$n=600,this.jn=1e4,this.Yn=1,this.Xn=[0,0,0],this.Jn=[0,0,-1,0,1,0],this.Kn=!1,this.Zn=null,this.Qn=new Map,this.th=new Set,this.sh=!1,this.ih=!1,this.eh="",this.nh=null,self.C3Audio_OnMicrophoneStream=(t,s)=>this.hh(t,s),this.oh=null,self.C3Audio_GetOutputStream=()=>this.rh(),self.C3Audio_DOMInterface=this,this.A([["create-audio-context",t=>this.ah(t)],["play",t=>this.uh(t)],["stop",t=>this.dh(t)],["stop-all",()=>this.wh()],["set-paused",t=>this.fh(t)],["set-volume",t=>this.mh(t)],["fade-volume",t=>this.ph(t)],["set-master-volume",t=>this.yh(t)],["set-muted",t=>this.gh(t)],["set-silent",t=>this.bh(t)],["set-looping",t=>this.Sh(t)],["set-playback-rate",t=>this._h(t)],["set-stereo-pan",t=>this.kh(t)],["seek",t=>this.Oh(t)],["preload",t=>this.xh(t)],["unload",t=>this.Ph(t)],["unload-all",()=>this.Mh()],["set-suspended",t=>this.Ch(t)],["add-effect",t=>this.Rh(t)],["set-effect-param",t=>this.Th(t)],["remove-effects",t=>this.Ih(t)],["tick",t=>this.Ah(t)],["load-state",t=>this.Eh(t)],["offline-render-audio",t=>this.Gh(t)],["offline-render-finish",()=>this.Fh()]])}async ah(t){if(t.usePlayMusicAsSoundWorkaround&&(this.Kn=!0),this.Vn=t.timeScaleMode,this.zn=["equalpower","HRTF","soundfield"][t.panningModel],this.qn=["linear","inverse","exponential"][t.distanceModel],this.$n=t.refDistance,this.jn=t.maxDistance,this.Yn=t.rolloffFactor,this.h.ii()){this.Kn=!0;const t=48e3;this.Cn=new OfflineAudioContext({numberOfChannels:2,sampleRate:t,length:Math.ceil(this.h.gi()*t)})}else this.Cn=new AudioContext({latencyHint:t.latencyHint}),"running"!==this.Cn.state&&this.Dh(),this.Cn.onstatechange=()=>{"running"===this.Cn.state?this.Lh():this.Dh(),this.S("audiocontext-state",{audioContextState:this.Cn.state})};this.Rn=this.Cn.createGain(),this.Rn.connect(this.Cn.destination);const s=t.listenerPos;this.Xn[0]=s[0],this.Xn[1]=s[1],this.Xn[2]=s[2],this.Cn.listener.setPosition(s[0],s[1],s[2]),this.Cn.listener.setOrientation(...this.Jn),self.C3_GetAudioContextCurrentTime=()=>this.Wh();try{await Promise.all(t.preloadList.map(t=>this.Uh(t.originalUrl,t.url,t.type,!1)))}catch(t){console.error("[Construct] Preloading sounds failed: ",t)}return{sampleRate:this.Cn.sampleRate,audioContextState:this.Cn.state,outputLatency:this.Cn.outputLatency||0}}Dh(){this.Tn||(window.addEventListener("pointerup",this.In,!0),window.addEventListener("touchend",this.In,!0),window.addEventListener("click",this.In,!0),window.addEventListener("keydown",this.In,!0),this.h.li(this.In),this.h.bs()||document.addEventListener("visibilitychange",this.In),this.Tn=!0)}Lh(){this.Tn&&(window.removeEventListener("pointerup",this.In,!0),window.removeEventListener("touchend",this.In,!0),window.removeEventListener("click",this.In,!0),window.removeEventListener("keydown",this.In,!0),this.h.wi(this.In),this.h.bs()||document.removeEventListener("visibilitychange",this.In),this.Tn=!1)}An(){"running"!==this.Cn.state&&this.Cn.resume()}Hh(t,s){for(const i of s){let s=!1;for(const e of t)if(self.Mn.Vh(e,i)){s=!0;break}if(!s)return!1}return!0}Bh(){return this.Cn}Wh(){return this.Cn.currentTime}Nh(){return this.Rn}GetAudioContextExtern(){return this.Bh()}GetDestinationNodeExtern(){return this.Nh()}zh(t){const s=this.Qn.get(t.toLowerCase());return s?s[0].qh():this.Nh()}$h(t,s){t=t.toLowerCase();let i=this.Qn.get(t);i||(i=[],this.Qn.set(t,i)),s.jh(i.length),s.Yh(t),i.push(s),this.Xh(t)}Xh(t){t=t.toLowerCase();let s=this.Nh();const i=this.Qn.get(t);if(i&&i.length){s=i[0].qh();for(let t=0,s=i.length;t<s;++t){const e=i[t];t+1===s?e.Jh(this.Nh()):e.Jh(i[t+1].qh())}}for(const i of this.Kh(t))i.Zh(s);this.nh&&this.eh===t&&(this.nh.disconnect(),this.nh.connect(s))}Qh(){return this.Hn}so(){return this.ve}io(){return this.Vn}eo(){return this.Bn}no(){return this.Nn}ho(){return this.Kn}oo(){return this.zn}ro(){return this.qn}ao(){return this.$n}co(){return this.jn}lo(){return this.Yn}ri(t){this.h.ri(t)}ai(t){this.h.ai(t)}uo(t){let s=0;for(let i=0,e=this.Gn.length;i<e;++i){const e=this.Gn[i];this.Gn[s]=e,e.do()===t?e.et():++s}this.Gn.length=s}wo(){let t=0;for(let s=0,i=this.En.length;s<i;++s){const i=this.En[s];this.En[t]=i,i.fo()&&i!==this.Zn?i.et():++t}this.En.length=t}*mo(t){if(t.length>0)for(const s of this.Gn)this.Hh(s.po(),t)&&(yield s);else this.Fn&&!this.Fn.yo()&&(yield this.Fn)}*Kh(t){if(t)for(const s of this.Gn)self.Mn.Vh(s.vo(),t)&&(yield s);else this.Fn&&!this.Fn.yo()&&(yield this.Fn)}async Uh(t,s,i,e,n){for(const t of this.En)if(t.bo()===s)return e&&this.Kn&&(this.Zn=t),await t.So(),t;if(n)return null;e&&this.Kn&&this.wo();const h=self.ko._o(this,t,s,i,e);return this.En.push(h),e&&this.Kn&&(this.Zn=h),await h.So(),this.Ln.has(t)||(this.S("buffer-metadata",{originalUrl:t,duration:h.Oo()}),this.Ln.add(t)),h}async xo(t,s,i,e,n){for(const t of this.Gn)if(t.bo()===s&&(t.Po()||n))return n&&this.Kn&&(this.Zn=t.do()),t.Mo(e),t;const h=await this.Uh(t,s,i,n);if(h.Co())throw new Error(`buffer '${t}' unloaded while loading`);const o=h.Ro(e);return this.Gn.push(o),o}To(t){const s=t.join(" ");let i=this.Un.get(s);if(!i){let t=null;i={Io:0,promise:new Promise(s=>t=s),resolve:t},this.Un.set(s,i)}i.Io++}Ao(t){const s=t.join(" "),i=this.Un.get(s);if(!i)throw new Error("expected pending tag");i.Io--,0===i.Io&&(i.resolve(),this.Un.delete(s))}Eo(t){const s=(0===t.length?this.Dn:t).join(" "),i=this.Un.get(s);return i?i.promise:Promise.resolve()}Go(){if(this.th.size>0)this.D();else for(const t of this.Gn)if(t.Fo())return void this.D()}m(){for(const t of this.th)t.m();const t=this.Wh();for(const s of this.Gn)s.m(t);const s=this.Gn.filter(t=>t.Fo()).map(t=>t.Do());this.S("state",{tickCount:this.Wn,outputLatency:this.Cn.outputLatency||0,audioInstances:s,analysers:[...this.th].map(t=>t.Lo())}),0===s.length&&0===this.th.size&&this.W()}Wo(t,s,i){this.S("trigger",{type:t,tags:s,aiid:i})}async uh(t){const s=t.originalUrl,i=t.url,e=t.type,n=t.isMusic,h=t.tags,o=t.isLooping,r=t.vol,a=t.pos,c=t.panning,l=t.stereoPan;let u=t.off;u>0&&!t.trueClock&&(u+=this.Wh()),this.Dn=h.slice(0),this.To(h);try{this.Fn=await this.xo(s,i,e,h,n),c?(this.Fn.Uo(!0),this.Fn.Ho(c.x,c.y,c.z,c.angle,c.innerAngle,c.outerAngle,c.outerGain),c.hasOwnProperty("uid")&&this.Fn.Vo(c.uid)):"number"==typeof l&&0!==l?(this.Fn.Bo(!0),this.Fn.No(l)):(this.Fn.Uo(!1),this.Fn.Bo(!1)),this.Fn.Play(o,r,a,u)}catch(t){return void console.error("[Construct] Audio: error starting playback: ",t)}finally{this.Ao(h)}this.D()}dh(t){const s=t.tags;for(const t of this.mo(s))t.zo()}wh(){for(const t of this.Gn)t.zo()}fh(t){const s=t.tags,i=t.paused;for(const t of this.mo(s))i?t.qo():t.$o();this.Go()}mh(t){const s=t.tags,i=t.vol;for(const t of this.mo(s))t.jo(i)}kh(t){const s=t.tags,i=t.p;for(const t of this.mo(s))t.Bo(!0),t.No(i)}async ph(t){const s=t.tags,i=t.vol,e=t.duration,n=t.stopOnEnd;await this.Eo(s);for(const t of this.mo(s))t.Yo(i,e,n);this.Go()}yh(t){this.Hn=t.vol,this.Rn.gain.value=this.Hn}gh(t){const s=t.tags,i=t.isMuted;for(const t of this.mo(s))t.Xo(i)}bh(t){this.ve=t.isSilent,this.h.mi(this.ve);for(const t of this.Gn)t.Jo()}Sh(t){const s=t.tags,i=t.isLooping;for(const t of this.mo(s))t.Ko(i)}async _h(t){const s=t.tags,i=t.rate;await this.Eo(s);for(const t of this.mo(s))t.Zo(i)}async Oh(t){const s=t.tags,i=t.pos;await this.Eo(s);for(const t of this.mo(s))t.Qo(i)}async xh(t){const s=t.originalUrl,i=t.url,e=t.type,n=t.isMusic;try{await this.xo(s,i,e,"",n)}catch(t){console.error("[Construct] Audio: error preloading: ",t)}}async Ph(t){const s=t.url,i=t.type,e=t.isMusic,n=await this.Uh("",s,i,e,!0);if(!n)return;n.et(),this.Zn===n&&(this.Zn=null);const h=this.En.indexOf(n);-1!==h&&this.En.splice(h,1)}Mh(){for(const t of this.En)t.et(),this.Zn===t&&(this.Zn=null);this.En.length=0}Ch(t){const s=t.isSuspended;!s&&this.Cn.resume&&this.Cn.resume();for(const t of this.Gn)t.tr(s);s&&this.Cn.suspend&&this.Cn.suspend()}Ah(t){if(this.Bn=t.timeScale,this.Nn=t.gameTime,this.Wn=t.tickCount,0!==this.Vn)for(const t of this.Gn)t.sr();const s=t.listenerPos;!s||this.Xn[0]===s[0]&&this.Xn[1]===s[1]&&this.Xn[2]===s[2]||(this.Xn[0]=s[0],this.Xn[1]=s[1],this.Xn[2]=s[2],this.Cn.listener.setPosition(s[0],s[1],s[2]));const i=t.listenerOrientation;if(i&&(this.Jn[0]!==i[0]||this.Jn[1]!==i[1]||this.Jn[2]!==i[2]||this.Jn[3]!==i[3]||this.Jn[4]!==i[4]||this.Jn[5]!==i[5])){for(let t=0;t<6;++t)this.Jn[t]=i[t];this.Cn.listener.setOrientation(...this.Jn)}for(const s of t.instPans){const t=s.uid;for(const i of this.Gn)i.ir()===t&&i.er(s.x,s.y,s.z,s.angle)}}async Rh(t){const s=t.type,i=t.hasOwnProperty("tags")?t.tags:[t.tag],e=t.params;let n,h;if("convolution"===s)try{h=await this.Uh(t.bufferOriginalUrl,t.bufferUrl,t.bufferType,!1)}catch(t){return void console.log("[Construct] Audio: error loading convolution: ",t)}for(const o of i){if("filter"===s)n=new self.nr(this,...e);else if("delay"===s)n=new self.hr(this,...e);else if("convolution"===s)n=new self.rr(this,h.ar(),...e),n.cr(t.bufferOriginalUrl,t.bufferUrl,t.bufferType);else if("flanger"===s)n=new self.lr(this,...e);else if("phaser"===s)n=new self.ur(this,...e);else if("gain"===s)n=new self.dr(this,...e);else if("stereopan"===s)n=new self.wr(this,...e);else if("tremolo"===s)n=new self.mr(this,...e);else if("ringmod"===s)n=new self.pr(this,...e);else if("distortion"===s)n=new self.yr(this,...e);else if("compressor"===s)n=new self.gr(this,...e);else{if("analyser"!==s)throw new Error("invalid effect type");n=new self.vr(this,...e)}this.$h(o,n)}this.br()}Th(t){const s=t.tags,i=t.index,e=t.param,n=t.value,h=t.ramp,o=t.time;for(const t of s){const s=this.Qn.get(t.toLowerCase());!s||i<0||i>=s.length||s[i].Sr(e,n,h,o)}this.br()}Ih(t){const s=t.tags;for(const t of s){const s=t.toLowerCase(),i=this.Qn.get(s);if(!i||!i.length)return;for(const t of i)t.et();this.Qn.delete(s),this.Xh(s)}}_r(t){this.th.add(t),this.Go()}kr(t){this.th.delete(t)}br(){this.sh||(this.sh=!0,Promise.resolve().then(()=>this.Or()))}Or(){const t={};for(const[s,i]of this.Qn)t[s]=i.map(t=>t.Do());this.S("fxstate",{fxstate:t}),this.sh=!1}async Eh(t){const s=t.saveLoadMode;if(3!==s){const t=[];for(const i of this.Gn)i.fo()&&1===s||!i.fo()&&2===s?t.push(i):i.et();this.Gn=t}for(const t of this.Qn.values())for(const s of t)s.et();this.Qn.clear(),this.Bn=t.timeScale,this.Nn=t.gameTime;const i=t.listenerPos;this.Xn[0]=i[0],this.Xn[1]=i[1],this.Xn[2]=i[2],this.Cn.listener.setPosition(i[0],i[1],i[2]);const e=t.listenerOrientation;if(Array.isArray(e)){for(let t=0;t<6;++t)this.Jn[t]=e[t];this.Cn.listener.setOrientation(...this.Jn)}this.ve=t.isSilent,this.h.mi(this.ve),this.Hn=t.masterVolume,this.Rn.gain.value=this.Hn;const n=[];for(const s of Object.values(t.effects))n.push(Promise.all(s.map(t=>this.Rh(t))));await Promise.all(n),await Promise.all(t.playing.map(t=>this.Pr(t,s))),this.Go()}async Pr(t,s){if(3===s)return;const i=t.bufferOriginalUrl,e=t.bufferUrl,n=t.bufferType,h=t.isMusic,o=t.tags,r=t.isLooping,a=t.volume,c=t.playbackTime;if(h&&1===s)return;if(!h&&2===s)return;let l=null;try{l=await this.xo(i,e,n,o,h)}catch(t){return void console.error("[Construct] Audio: error loading audio state: ",t)}l.Mr(t.pan),l.Cr(t.stereoPan),l.Play(r,a,c,0),t.isPlaying||l.qo(),l.Rr(t)}hh(t,s){this.nh&&this.nh.disconnect(),this.eh=s.toLowerCase(),this.nh=this.Cn.createMediaStreamSource(t),this.nh.connect(this.zh(this.eh))}rh(){return this.oh||(this.oh=this.Cn.createMediaStreamDestination(),this.Rn.connect(this.oh)),this.oh.stream}async Gh(t){try{const s=t.time,i=this.Cn.suspend(s);this.ih?this.Cn.resume():(this.Cn.startRendering().then(t=>this.Tr(t)).catch(t=>this.Ir(t)),this.ih=!0),await i}catch(t){this.Ir(t)}}Fh(){this.Cn.resume()}Tr(t){const s=[];for(let i=0,e=t.numberOfChannels;i<e;++i){const e=t.getChannelData(i);s.push(e.buffer)}this.h._("runtime","offline-audio-render-completed",{duration:t.duration,length:t.length,numberOfChannels:t.numberOfChannels,sampleRate:t.sampleRate,channelData:s},null,s)}Ir(t){console.error("[Audio] Offline rendering error: ",t)}static Vh(t,s){return t===s||t.normalize().toLowerCase()===s.normalize().toLowerCase()}static Ar(t){return t*K}static Er(t){return Math.pow(10,t/20)}static Gr(t){return Math.max(Math.min(self.Mn.Er(t),1),0)}static Fr(t){return Math.log(t)/Math.log(10)*20}static Dr(t){return self.Mn.Fr(Math.max(Math.min(t,1),0))}static Lr(t,s){return 1-Math.exp(-s*t)}},self.ss.ei(self.Mn)}self.ko=class{constructor(t,s,i,e,n){this.Wr=t,this.Ur=s,this.Hr=i,this.Vr=e,this.Br=n,this.Nr="",this.zr="not-loaded",this.qr=null}et(){this.zr="not-loaded",this.Wr=null,this.qr=null}Co(){return!this.Wr}static _o(t,s,i,e,n){return!n||t.ho()?new self.$r(t,s,i,e,n):new self.jr(t,s,i,e,n)}Ro(t){return"html5"===this.Nr?new self.Yr(this.Wr,this,t):new self.Xr(this.Wr,this,t)}Jr(){}So(){return this.qr||(this.qr=this.Jr()),this.qr}Kr(){}Zr(){}Qr(){return"failed"===this.zr}Bh(){return this.Wr.Bh()}ta(){return this.Nr}sa(){return this.Ur}bo(){return this.Hr}ia(){return this.Vr}fo(){return this.Br}Oo(){}},self.jr=class extends self.ko{constructor(t,s,i,e,n){super(t,s,i,e,n),this.Nr="html5",this.ea=new Audio,this.ea.crossOrigin="anonymous",this.ea.autoplay=!1,this.ea.preload="auto",this.na=null,this.ha=null,this.oa=!1,this.ea.addEventListener("canplaythrough",()=>this.oa=!0),this.ra=this.Bh().createGain(),this.aa=null,this.ea.addEventListener("canplay",()=>{this.na&&(this.zr="loaded",this.na(),this.na=null,this.ha=null),!this.aa&&this.ea&&(this.aa=this.Bh().createMediaElementSource(this.ea),this.aa.connect(this.ra))}),this.onended=null,this.ea.addEventListener("ended",()=>{this.onended&&this.onended()}),this.ea.addEventListener("error",t=>this.ca(t))}et(){this.Wr.uo(this),this.ra.disconnect(),this.ra=null,this.aa.disconnect(),this.aa=null,this.ea&&!this.ea.paused&&this.ea.pause(),this.onended=null,this.ea=null,super.et()}Jr(){return this.zr="loading",new Promise((t,s)=>{this.na=t,this.ha=s,this.ea.src=this.Hr})}ca(t){console.error(`[Construct] Audio '${this.Hr}' error: `,t),this.ha&&(this.zr="failed",this.ha(t),this.na=null,this.ha=null)}Kr(){const t=this.ea.readyState>=4;return t&&(this.oa=!0),t||this.oa}Zr(){return this.Kr()}la(){return this.ea}ua(){return this.ra}Oo(){return this.ea.duration}},self.$r=class extends self.ko{constructor(t,s,i,e,n){super(t,s,i,e,n),this.Nr="webaudio",this.da=null,this.wa=null}et(){this.Wr.uo(this),this.da=null,this.wa=null,super.et()}async fa(){if(this.da)return this.da;const t=this.Wr.G();if("playable-ad-single-file"===t.ys()&&t.Si(this.Hr)){const s=t._PlayableAdFetchBlob(this.Hr);this.da=await s.arrayBuffer()}else{const t=await fetch(this.Hr);if(!t.ok)throw new Error(`error fetching audio data: ${t.status} ${t.statusText}`);this.da=await t.arrayBuffer()}}async ma(){if(this.wa)return this.wa;const t=this.Wr.Bh();this.wa=await t.decodeAudioData(this.da),this.da=null}async Jr(){try{if(this.zr="loading",await this.fa(),this.Co())return;await this.ma(),this.zr="loaded"}catch(t){this.zr="failed",console.error(`[Construct] Failed to load audio '${this.Hr}': `,t)}}Kr(){return!(!this.da&&!this.wa)}Zr(){return!!this.wa}ar(){return this.wa}Oo(){return this.wa?this.wa.duration:0}};{let Q=0;self.pa=class{constructor(t,s,i){this.Wr=t,this.ya=s,this.ga=i,this.va=this.vo(),this.ba=Q++,this.Sa=this.Bh().createGain(),this.Sa.connect(this.Nh()),this._a=null,this.ka=!1,this.Oa=[0,0,0],this.xa=[0,0,0],this.Pa=[0,0,0],this.Ma=null,this.Ca=!1,this.Ra=0,this.Ta=!0,this.Ia=!1,this.Aa=!1,this.Ea=!1,this.Ga=1,this.Fa=!1,this.Da=1;const e=this.Wr.io();this.La=1===e&&!this.fo()||2===e,this.Wa=-1,this.Ua=-1,this.Ha=!1}et(){this.Wr=null,this.ya=null,this._a&&(this._a.disconnect(),this._a=null),this.Ma&&(this.Ma.disconnect(),this.Ma=null),this.Sa.disconnect(),this.Sa=null}Bh(){return this.Wr.Bh()}Mo(t){this.ga=t;const s=this.vo();this.va!==s&&(this.va=s,this.Zh(this.Nh()))}po(){return this.ga}vo(){return this.ga.length>0?this.ga[0]:""}Nh(){return this.Wr.zh(this.vo())}Va(){return this.La?this.Wr.no():performance.now()/1e3}sa(){return this.ya.sa()}bo(){return this.ya.bo()}ia(){return this.ya.ia()}do(){return this.ya}fo(){return this.ya.fo()}Ba(){return this.ba}yo(){}Po(){}IsPlaying(){return!this.Ta&&!this.Ia&&!this.yo()}Fo(){return!this.Ta&&!this.yo()}Na(){}Oo(t){let s=this.ya.Oo();return t&&(s/=this.Da||.001),s}Play(t,s,i,e){}zo(){}qo(){}za(){return this.Ia}$o(){}jo(t){this.Ga=t,this.Sa.gain.cancelScheduledValues(0),this.Ua=-1,this.Sa.gain.value=this.qa()}Yo(t,s,i){if(this.$a())return;const e=this.Sa.gain;e.cancelScheduledValues(0);const n=this.Wr.Wh(),h=n+s;e.setValueAtTime(e.value,n),e.linearRampToValueAtTime(t,h),this.Ga=t,this.Ua=h,this.Ha=i}ja(){this.jo(this.Ga)}m(t){-1!==this.Ua&&t>=this.Ua&&(this.Ua=-1,this.Ha&&this.zo(),this.Wr.Wo("fade-ended",this.ga,this.ba))}qa(){const t=this.Ga;return isFinite(t)?t:0}Xo(t){t=!!t,this.Fa!==t&&(this.Fa=t,this.Jo())}$a(){return this.Fa}so(){return this.Wr.so()}Jo(){}Ko(t){}Ya(){return this.Ea}Zo(t){this.Da!==t&&(this.Da=t,this.sr())}sr(){}Xa(){return this.Da}Qo(t){}tr(t){}Uo(t){t=!!t,this.ka!==t&&(this.ka=t,this.ka?(this.Bo(!1),this._a||(this._a=this.Bh().createPanner(),this._a.panningModel=this.Wr.oo(),this._a.distanceModel=this.Wr.ro(),this._a.refDistance=this.Wr.ao(),this._a.maxDistance=this.Wr.co(),this._a.rolloffFactor=this.Wr.lo()),this.Sa.disconnect(),this.Sa.connect(this._a),this._a.connect(this.Nh())):(this._a.disconnect(),this.Sa.disconnect(),this.Sa.connect(this.Nh())))}Ho(t,s,i,e,n,h,o){if(!this.ka)return;this.er(t,s,i,e);const r=self.Mn.Ar;this.Pa[0]!==r(n)&&(this.Pa[0]=r(n),this._a.coneInnerAngle=r(n)),this.Pa[1]!==r(h)&&(this.Pa[1]=r(h),this._a.coneOuterAngle=r(h)),this.Pa[2]!==o&&(this.Pa[2]=o,this._a.coneOuterGain=o)}er(t,s,i,e){if(!this.ka)return;const n=this.Oa,h=this.xa,o=Math.cos(e),r=Math.sin(e);n[0]===t&&n[1]===s&&n[2]===i||(n[0]=t,n[1]=s,n[2]=i,this._a.setPosition(...n)),h[0]===o&&h[1]===r&&0===h[2]||(h[0]=o,h[1]=r,h[2]=0,this._a.setOrientation(...h))}Bo(t){t=!!t,this.Ca!==t&&(this.Ca=t,this.Ca?(this.Uo(!1),this.Ma=this.Bh().createStereoPanner(),this.Sa.disconnect(),this.Sa.connect(this.Ma),this.Ma.connect(this.Nh())):(this.Ma.disconnect(),this.Ma=null,this.Sa.disconnect(),this.Sa.connect(this.Nh())))}No(t){this.Ca&&this.Ra!==t&&(this.Ma.pan.value=t,this.Ra=t)}Vo(t){this.Wa=t}ir(){return this.Wa}Ja(){}Zh(t){const s=this.Ma||this._a||this.Sa;s.disconnect(),s.connect(t)}Do(){return{aiid:this.Ba(),tags:this.ga,duration:this.Oo(),volume:-1===this.Ua?this.Ga:this.Sa.gain.value,isPlaying:this.IsPlaying(),playbackTime:this.Na(),playbackRate:this.Xa(),uid:this.Wa,bufferOriginalUrl:this.sa(),bufferUrl:"",bufferType:this.ia(),isMusic:this.fo(),isLooping:this.Ya(),isMuted:this.$a(),resumePosition:this.Ja(),pan:this.Ka(),stereoPan:this.Za()}}Rr(t){this.Zo(t.playbackRate),this.Xo(t.isMuted)}Ka(){if(!this._a)return null;const t=this._a;return{pos:this.Oa,orient:this.xa,cia:t.coneInnerAngle,coa:t.coneOuterAngle,cog:t.coneOuterGain,uid:this.Wa}}Mr(t){if(!t)return void this.Uo(!1);this.Uo(!0);const s=this._a,i=t.pos;this.Oa[0]=i[0],this.Oa[1]=i[1],this.Oa[2]=i[2];const e=t.orient;this.xa[0]=e[0],this.xa[1]=e[1],this.xa[2]=e[2],s.setPosition(...this.Oa),s.setOrientation(...this.xa),this.Pa[0]=t.cia,this.Pa[1]=t.coa,this.Pa[2]=t.cog,s.coneInnerAngle=t.cia,s.coneOuterAngle=t.coa,s.coneOuterGain=t.cog,this.Wa=t.uid}Za(){return this.Ma?this.Ra:null}Cr(t){"number"==typeof t?(this.Bo(!0),this.No(t)):this.Bo(!1)}}}self.Yr=class extends self.pa{constructor(t,s,i){super(t,s,i),this.ya.ua().connect(this.Sa),this.ya.onended=()=>this.Qa()}et(){this.zo(),this.ya.ua().disconnect(),super.et()}la(){return this.ya.la()}Qa(){this.Ta=!0,this.Wa=-1,this.Wr.Wo("ended",this.ga,this.ba)}yo(){return this.la().ended}Po(){return!!this.Ta||this.yo()}Na(){let t=this.la().currentTime;return this.Ea||(t=Math.min(t,this.Oo())),t}Play(t,s,i,e){const n=this.la();if(1!==n.playbackRate&&(n.playbackRate=1),n.loop!==t&&(n.loop=t),this.jo(s),this.Fa=!1,n.muted&&(n.muted=!1),n.currentTime!==i)try{n.currentTime=i}catch(t){console.warn(`[Construct] Exception seeking audio '${this.ya.bo()}' to position '${i}': `,t)}this.Wr.ri(n),this.Ta=!1,this.Ia=!1,this.Ea=t,this.Da=1}zo(){const t=this.la();t.paused||t.pause(),this.Wr.ai(t),this.Ta=!0,this.Ia=!1,this.Wa=-1}qo(){if(this.Ia||this.Ta||this.yo())return;const t=this.la();t.paused||t.pause(),this.Wr.ai(t),this.Ia=!0}$o(){!this.Ia||this.Ta||this.yo()||(this.Wr.ri(this.la()),this.Ia=!1)}Jo(){this.la().muted=this.Fa||this.so()}Ko(t){t=!!t,this.Ea!==t&&(this.Ea=t,this.la().loop=t)}sr(){let t=this.Da;this.La&&(t*=this.Wr.eo());try{this.la().playbackRate=t}catch(s){console.warn(`[Construct] Unable to set playback rate '${t}':`,s)}}Qo(t){if(!this.Ta&&!this.yo())try{this.la().currentTime=t}catch(s){console.warn(`[Construct] Error seeking audio to '${t}': `,s)}}Ja(){return this.Na()}tr(t){t?this.IsPlaying()?(this.la().pause(),this.Aa=!0):this.Aa=!1:this.Aa&&(this.Wr.ri(this.la()),this.Aa=!1)}},self.Xr=class extends self.pa{constructor(t,s,i){super(t,s,i),this.tc=null,this.sc=t=>this.Qa(t),this.ec=!0,this.nc=null,this.hc=0,this.oc=0,this.rc=0,this.ac=1}et(){this.zo(),this.cc(),this.sc=null,super.et()}cc(){this.tc&&(this.tc.onended=null,this.tc.disconnect(),this.tc.buffer=null),this.tc=null,this.nc=null}Qa(t){this.Ia||this.Aa||t.target===this.nc&&(this.ec=!0,this.Ta=!0,this.Wa=-1,this.cc(),this.Wr.Wo("ended",this.ga,this.ba))}yo(){return!(!this.Ta&&this.tc&&this.tc.loop)&&!this.Ia&&this.ec}Po(){return!(this.tc&&!this.Ta)||this.yo()}Na(){let t=0;return t=this.Ia?this.rc:this.oc+(this.Va()-this.hc)*this.Da,this.Ea||(t=Math.min(t,this.Oo())),t}Play(t,s,i,e){this.Fa=!1,this.ac=1,this.jo(s),this.cc(),this.tc=this.Bh().createBufferSource(),this.tc.buffer=this.ya.ar(),this.tc.connect(this.Sa),this.nc=this.tc,this.tc.onended=this.sc,this.tc.loop=t,this.tc.start(e,i),this.ec=!1,this.Ta=!1,this.Ia=!1,this.Ea=t,this.Da=1,this.hc=this.Va(),this.oc=i}zo(){if(this.tc)try{this.tc.stop(0)}catch(t){}this.Ta=!0,this.Ia=!1,this.Wa=-1}qo(){this.Ia||this.Ta||this.yo()||(this.rc=this.Na(),this.Ea&&(this.rc%=this.Oo()),this.Ia=!0,this.tc.stop(0))}$o(){!this.Ia||this.Ta||this.yo()||(this.cc(),this.tc=this.Bh().createBufferSource(),this.tc.buffer=this.ya.ar(),this.tc.connect(this.Sa),this.nc=this.tc,this.tc.onended=this.sc,this.tc.loop=this.Ea,this.ja(),this.sr(),this.tc.start(0,this.rc),this.hc=this.Va(),this.oc=this.rc,this.Ia=!1)}qa(){return super.qa()*this.ac}Jo(){this.ac=this.Fa||this.so()?0:1,this.ja()}Ko(t){t=!!t,this.Ea!==t&&(this.Ea=t,this.tc&&(this.tc.loop=t))}sr(){let t=this.Da;this.La&&(t*=this.Wr.eo()),this.tc&&(this.tc.playbackRate.value=t)}Qo(t){this.Ta||this.yo()||(this.Ia?this.rc=t:(this.qo(),this.rc=t,this.$o()))}Ja(){return this.rc}tr(t){t?this.IsPlaying()?(this.Aa=!0,this.rc=this.Na(),this.Ea&&(this.rc%=this.Oo()),this.tc.stop(0)):this.Aa=!1:this.Aa&&(this.cc(),this.tc=this.Bh().createBufferSource(),this.tc.buffer=this.ya.ar(),this.tc.connect(this.Sa),this.nc=this.tc,this.tc.onended=this.sc,this.tc.loop=this.Ea,this.ja(),this.sr(),this.tc.start(0,this.rc),this.hc=this.Va(),this.oc=this.rc,this.Aa=!1)}Rr(t){super.Rr(t),this.rc=t.resumePosition}};{class tt{constructor(t){this.Wr=t,this.Cn=t.Bh(),this.lc=-1,this.uc="",this.Vr="",this.dc=null}et(){this.Cn=null}jh(t){this.lc=t}wc(){return this.lc}Yh(t){this.uc=t}fc(){return this.uc}mc(){return this.Cn.createGain()}qh(){}Jh(t){}yc(t,s,i,e){if(t.cancelScheduledValues(0),0===e)return void(t.value=s);const n=this.Cn.currentTime;switch(e+=n,i){case 0:t.setValueAtTime(s,e);break;case 1:t.setValueAtTime(t.value,n),t.linearRampToValueAtTime(s,e);break;case 2:t.setValueAtTime(t.value,n),t.exponentialRampToValueAtTime(s,e)}}Do(){return{type:this.Vr,tag:this.uc,params:this.dc}}}self.nr=class extends tt{constructor(t,s,i,e,n,h,o){super(t),this.Vr="filter",this.dc=[s,i,e,n,h,o],this.vc=this.mc(),this.bc=this.mc(),this.bc.gain.value=o,this.Sc=this.mc(),this.Sc.gain.value=1-o,this._c=this.Cn.createBiquadFilter(),this._c.type=s,this._c.frequency.value=i,this._c.detune.value=e,this._c.Q.value=n,this._c.gain.vlaue=h,this.vc.connect(this._c),this.vc.connect(this.Sc),this._c.connect(this.bc)}et(){this.vc.disconnect(),this._c.disconnect(),this.bc.disconnect(),this.Sc.disconnect(),super.et()}Jh(t){this.bc.disconnect(),this.bc.connect(t),this.Sc.disconnect(),this.Sc.connect(t)}qh(){return this.vc}Sr(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.dc[5]=s,this.yc(this.bc.gain,s,i,e),this.yc(this.Sc.gain,1-s,i,e);break;case 1:this.dc[1]=s,this.yc(this._c.frequency,s,i,e);break;case 2:this.dc[2]=s,this.yc(this._c.detune,s,i,e);break;case 3:this.dc[3]=s,this.yc(this._c.Q,s,i,e);break;case 4:this.dc[4]=s,this.yc(this._c.gain,s,i,e)}}},self.hr=class extends tt{constructor(t,s,i,e){super(t),this.Vr="delay",this.dc=[s,i,e],this.vc=this.mc(),this.bc=this.mc(),this.bc.gain.value=e,this.Sc=this.mc(),this.Sc.gain.value=1-e,this.kc=this.mc(),this.Oc=this.Cn.createDelay(s),this.Oc.delayTime.value=s,this.xc=this.mc(),this.xc.gain.value=i,this.vc.connect(this.kc),this.vc.connect(this.Sc),this.kc.connect(this.bc),this.kc.connect(this.Oc),this.Oc.connect(this.xc),this.xc.connect(this.kc)}et(){this.vc.disconnect(),this.bc.disconnect(),this.Sc.disconnect(),this.kc.disconnect(),this.Oc.disconnect(),this.xc.disconnect(),super.et()}Jh(t){this.bc.disconnect(),this.bc.connect(t),this.Sc.disconnect(),this.Sc.connect(t)}qh(){return this.vc}Sr(t,s,i,e){const n=self.Mn.Gr;switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.dc[2]=s,this.yc(this.bc.gain,s,i,e),this.yc(this.Sc.gain,1-s,i,e);break;case 4:this.dc[1]=n(s),this.yc(this.xc.gain,n(s),i,e);break;case 5:this.dc[0]=s,this.yc(this.Oc.delayTime,s,i,e)}}},self.rr=class extends tt{constructor(t,s,i,e){super(t),this.Vr="convolution",this.dc=[i,e],this.Pc="",this.Mc="",this.Cc="",this.vc=this.mc(),this.bc=this.mc(),this.bc.gain.value=e,this.Sc=this.mc(),this.Sc.gain.value=1-e,this.Rc=this.Cn.createConvolver(),this.Rc.normalize=i,this.Rc.buffer=s,this.vc.connect(this.Rc),this.vc.connect(this.Sc),this.Rc.connect(this.bc)}et(){this.vc.disconnect(),this.Rc.disconnect(),this.bc.disconnect(),this.Sc.disconnect(),super.et()}Jh(t){this.bc.disconnect(),this.bc.connect(t),this.Sc.disconnect(),this.Sc.connect(t)}qh(){return this.vc}Sr(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.dc[1]=s,this.yc(this.bc.gain,s,i,e),this.yc(this.Sc.gain,1-s,i,e))}cr(t,s,i){this.Pc=t,this.Mc=s,this.Cc=i}Do(){const t=super.Do();return t.bufferOriginalUrl=this.Pc,t.bufferUrl="",t.bufferType=this.Cc,t}},self.lr=class extends tt{constructor(t,s,i,e,n,h){super(t),this.Vr="flanger",this.dc=[s,i,e,n,h],this.vc=this.mc(),this.Sc=this.mc(),this.Sc.gain.value=1-h/2,this.bc=this.mc(),this.bc.gain.value=h/2,this.Tc=this.mc(),this.Tc.gain.value=n,this.Oc=this.Cn.createDelay(s+i),this.Oc.delayTime.value=s,this.Ic=this.Cn.createOscillator(),this.Ic.frequency.value=e,this.Ac=this.mc(),this.Ac.gain.value=i,this.vc.connect(this.Oc),this.vc.connect(this.Sc),this.Oc.connect(this.bc),this.Oc.connect(this.Tc),this.Tc.connect(this.Oc),this.Ic.connect(this.Ac),this.Ac.connect(this.Oc.delayTime),this.Ic.start(0)}et(){this.Ic.stop(0),this.vc.disconnect(),this.Oc.disconnect(),this.Ic.disconnect(),this.Ac.disconnect(),this.Sc.disconnect(),this.bc.disconnect(),this.Tc.disconnect(),super.et()}Jh(t){this.bc.disconnect(),this.bc.connect(t),this.Sc.disconnect(),this.Sc.connect(t)}qh(){return this.vc}Sr(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.dc[4]=s,this.yc(this.bc.gain,s/2,i,e),this.yc(this.Sc.gain,1-s/2,i,e);break;case 6:this.dc[1]=s/1e3,this.yc(this.Ac.gain,s/1e3,i,e);break;case 7:this.dc[2]=s,this.yc(this.Ic.frequency,s,i,e);break;case 8:this.dc[3]=s/100,this.yc(this.Tc.gain,s/100,i,e)}}},self.ur=class extends tt{constructor(t,s,i,e,n,h,o){super(t),this.Vr="phaser",this.dc=[s,i,e,n,h,o],this.vc=this.mc(),this.Sc=this.mc(),this.Sc.gain.value=1-o/2,this.bc=this.mc(),this.bc.gain.value=o/2,this._c=this.Cn.createBiquadFilter(),this._c.type="allpass",this._c.frequency.value=s,this._c.detune.value=i,this._c.Q.value=e,this.Ic=this.Cn.createOscillator(),this.Ic.frequency.value=h,this.Ac=this.mc(),this.Ac.gain.value=n,this.vc.connect(this._c),this.vc.connect(this.Sc),this._c.connect(this.bc),this.Ic.connect(this.Ac),this.Ac.connect(this._c.frequency),this.Ic.start(0)}et(){this.Ic.stop(0),this.vc.disconnect(),this._c.disconnect(),this.Ic.disconnect(),this.Ac.disconnect(),this.Sc.disconnect(),this.bc.disconnect(),super.et()}Jh(t){this.bc.disconnect(),this.bc.connect(t),this.Sc.disconnect(),this.Sc.connect(t)}qh(){return this.vc}Sr(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.dc[5]=s,this.yc(this.bc.gain,s/2,i,e),this.yc(this.Sc.gain,1-s/2,i,e);break;case 1:this.dc[0]=s,this.yc(this._c.frequency,s,i,e);break;case 2:this.dc[1]=s,this.yc(this._c.detune,s,i,e);break;case 3:this.dc[2]=s,this.yc(this._c.Q,s,i,e);break;case 6:this.dc[3]=s,this.yc(this.Ac.gain,s,i,e);break;case 7:this.dc[4]=s,this.yc(this.Ic.frequency,s,i,e)}}},self.dr=class extends tt{constructor(t,s){super(t),this.Vr="gain",this.dc=[s],this.Ec=this.mc(),this.Ec.gain.value=s}et(){this.Ec.disconnect(),super.et()}Jh(t){this.Ec.disconnect(),this.Ec.connect(t)}qh(){return this.Ec}Sr(t,s,i,e){const n=self.Mn.Gr;4===t&&(this.dc[0]=n(s),this.yc(this.Ec.gain,n(s),i,e))}},self.wr=class extends tt{constructor(t,s){super(t),this.Vr="stereopan",this.dc=[s],this.Ec=this.Cn.createStereoPanner(),this.Ec.pan.value=s}et(){this.Ec.disconnect(),super.et()}Jh(t){this.Ec.disconnect(),this.Ec.connect(t)}qh(){return this.Ec}Sr(t,s,i,e){s=Math.min(Math.max(s/100,-1),1),9===t&&(this.dc[0]=s,this.yc(this.Ec.pan,s,i,e))}},self.mr=class extends tt{constructor(t,s,i){super(t),this.Vr="tremolo",this.dc=[s,i],this.Ec=this.mc(),this.Ec.gain.value=1-i/2,this.Ic=this.Cn.createOscillator(),this.Ic.frequency.value=s,this.Ac=this.mc(),this.Ac.gain.value=i/2,this.Ic.connect(this.Ac),this.Ac.connect(this.Ec.gain),this.Ic.start(0)}et(){this.Ic.stop(0),this.Ic.disconnect(),this.Ac.disconnect(),this.Ec.disconnect(),super.et()}Jh(t){this.Ec.disconnect(),this.Ec.connect(t)}qh(){return this.Ec}Sr(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.dc[1]=s,this.yc(this.Ec.gain,1-s/2,i,e),this.yc(this.Ac.gain,s/2,i,e);break;case 7:this.dc[0]=s,this.yc(this.Ic.frequency,s,i,e)}}},self.pr=class extends tt{constructor(t,s,i){super(t),this.Vr="ringmod",this.dc=[s,i],this.vc=this.mc(),this.bc=this.mc(),this.bc.gain.value=i,this.Sc=this.mc(),this.Sc.gain.value=1-i,this.Gc=this.mc(),this.Gc.gain.value=0,this.Ic=this.Cn.createOscillator(),this.Ic.frequency.value=s,this.Ic.connect(this.Gc.gain),this.Ic.start(0),this.vc.connect(this.Gc),this.vc.connect(this.Sc),this.Gc.connect(this.bc)}et(){this.Ic.stop(0),this.Ic.disconnect(),this.Gc.disconnect(),this.vc.disconnect(),this.bc.disconnect(),this.Sc.disconnect(),super.et()}Jh(t){this.bc.disconnect(),this.bc.connect(t),this.Sc.disconnect(),this.Sc.connect(t)}qh(){return this.vc}Sr(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.dc[1]=s,this.yc(this.bc.gain,s,i,e),this.yc(this.Sc.gain,1-s,i,e);break;case 7:this.dc[0]=s,this.yc(this.Ic.frequency,s,i,e)}}},self.yr=class extends tt{constructor(t,s,i,e,n,h){super(t),this.Vr="distortion",this.dc=[s,i,e,n,h],this.vc=this.mc(),this.Fc=this.mc(),this.Dc=this.mc(),this.Lc(e,n),this.bc=this.mc(),this.bc.gain.value=h,this.Sc=this.mc(),this.Sc.gain.value=1-h,this.Wc=this.Cn.createWaveShaper(),this.Uc=new Float32Array(65536),this.Hc(s,i),this.Wc.curve=this.Uc,this.vc.connect(this.Fc),this.vc.connect(this.Sc),this.Fc.connect(this.Wc),this.Wc.connect(this.Dc),this.Dc.connect(this.bc)}et(){this.vc.disconnect(),this.Fc.disconnect(),this.Wc.disconnect(),this.Dc.disconnect(),this.bc.disconnect(),this.Sc.disconnect(),super.et()}Lc(t,s){t<.01&&(t=.01),this.Fc.gain.value=t,this.Dc.gain.value=Math.pow(1/t,.6)*s}Hc(t,s){const i=32768;for(let e=0;e<i;++e){let n=e/i;n=this.Vc(n,t,s),this.Uc[i+e]=n,this.Uc[i-e-1]=-n}}Vc(t,s,i){const e=1.05*i*s-s,n=t<0?-1:1,h=t<0?-t:t;let o=h<s?h:s+e*self.Mn.Lr(h-s,1/e);return o*=n,o}Jh(t){this.bc.disconnect(),this.bc.connect(t),this.Sc.disconnect(),this.Sc.connect(t)}qh(){return this.vc}Sr(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.dc[4]=s,this.yc(this.bc.gain,s,i,e),this.yc(this.Sc.gain,1-s,i,e))}},self.gr=class extends tt{constructor(t,s,i,e,n,h){super(t),this.Vr="compressor",this.dc=[s,i,e,n,h],this.Ec=this.Cn.createDynamicsCompressor(),this.Ec.threshold.value=s,this.Ec.knee.value=i,this.Ec.ratio.value=e,this.Ec.attack.value=n,this.Ec.release.value=h}et(){this.Ec.disconnect(),super.et()}Jh(t){this.Ec.disconnect(),this.Ec.connect(t)}qh(){return this.Ec}Sr(t,s,i,e){}},self.vr=class extends tt{constructor(t,s,i){super(t),this.Vr="analyser",this.dc=[s,i],this.Ec=this.Cn.createAnalyser(),this.Ec.fftSize=s,this.Ec.smoothingTimeConstant=i,this.Bc=new Float32Array(this.Ec.frequencyBinCount),this.Nc=new Uint8Array(s),this.zc=0,this.qc=0,this.Wr._r(this)}et(){this.Wr.kr(this),this.Ec.disconnect(),super.et()}m(){this.Ec.getFloatFrequencyData(this.Bc),this.Ec.getByteTimeDomainData(this.Nc);const t=this.Ec.fftSize;this.zc=0;let s=0;for(let i=0;i<t;++i){let t=(this.Nc[i]-128)/128;t<0&&(t=-t),this.zc<t&&(this.zc=t),s+=t*t}const i=self.Mn.Dr;this.zc=i(this.zc),this.qc=i(Math.sqrt(s/t))}Jh(t){this.Ec.disconnect(),this.Ec.connect(t)}qh(){return this.Ec}Sr(t,s,i,e){}Lo(){return{tag:this.fc(),index:this.wc(),peak:this.zc,rms:this.qc,binCount:this.Ec.frequencyBinCount,freqBins:this.Bc}}}}{const st="keyboard",it=class extends self.i{constructor(t){super(t,st),this.$c=!(!navigator.keyboard||!navigator.keyboard.lock),this.A([["init",()=>this.jc()],["lock-keyboard",t=>this.Yc(t)],["unlock-keyboard",()=>this.Xc()]])}jc(){return{isKeyboardLockSupported:this.$c}}async Yc(t){const s=t.keysArr;try{return 0===s.length?await navigator.keyboard.lock():await navigator.keyboard.lock(s),{isOk:!0}}catch(t){return console.error("Error locking keyboard:",t),{isOk:!1}}}Xc(){try{navigator.keyboard.unlock()}catch(t){console.error("Error unlocking keyboard:",t)}}};self.ss.ei(it)}if(window.C3_IsSupported){const et=!0;window.c3_runtimeInterface=new self.ss({es:et,Ws:"workermain.js",Bs:["scripts/c3main.js"],ns:"scripts/",hs:"html5"})}